"use strict";(self.webpackChunksunbird_obsrv=self.webpackChunksunbird_obsrv||[]).push([[669],{69835:(e,t,s)=>{s.d(t,{A:()=>y,W:()=>x});var a=s(26240),i=s(81e3),n=s(10611),r=s(85865),l=s(35721),o=s(30681),d=s(48734),c=s(85976),h=s(81129),u=s(36091),m=s(61966),f=s(73012),v=s(70579);function p(e){let{value:t,theme:s,...a}=e;return(0,v.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",maxWidth:"22rem"},children:[(0,v.jsx)(i.A,{sx:{width:"20rem",mr:1,color:s.palette.primary[400]},children:(0,v.jsx)(n.A,{variant:"determinate",color:"inherit",...a})}),(0,v.jsx)(i.A,{sx:{minWidth:35},children:(0,v.jsx)(r.A,{variant:"h6",color:"text.secondary",children:`${Math.round(t)}%`})})]})}function x(e,t){return"string"===typeof e?{key:t?`${e}-${t}`:e,preview:e}:{key:t?`${e.name}-${t}`:e.name,name:e.name,size:e.size,path:e.path,type:e.type,preview:e.preview,lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate}}function y(e){let{showList:t=!1,files:s,onRemove:i,type:n}=e;const y=(0,a.A)(),A=s.length>0;return(0,v.jsx)(l.A,{disablePadding:!0,sx:{...A&&n!==h.r.standard&&{my:3},...n===h.r.standard&&{width:"calc(100% - 84px)"}},children:s.map(((e,t)=>{const{key:s,name:a,size:n,preview:l,type:h}=x(e,t);return(0,v.jsxs)(o.Ay,{sx:{my:1,px:2,py:.75,borderRadius:.75,border:e=>`solid 1px ${e.palette.divider}`,alignItems:"center"},children:[(0,v.jsx)(u.A,{style:{width:"30px",fontSize:"1.15rem",marginRight:4}}),(0,v.jsx)(d.A,{primary:(0,v.jsx)(r.A,{textOverflow:"ellipsis",overflow:"hidden",variant:"body1",children:"string"===typeof e?e:a}),primaryTypographyProps:{variant:"subtitle2"},secondaryTypographyProps:{variant:"caption"},sx:{mr:2,maxWidth:250,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}}),(0,v.jsx)(p,{value:100,theme:y}),i&&(0,v.jsx)(c.A,{"data-edataid":`${f.file_remove_single}:${s}`,size:"small",color:"error",shape:"rounded",onClick:()=>i(e),sx:{ml:"auto"},edge:"end",children:(0,v.jsx)(m.A,{style:{fontSize:"1rem"}})})]},s)}))})}},31694:(e,t,s)=>{s.d(t,{Ay:()=>u});var a=s(90310),i=s(63336),n=s(81e3),r=s(85865),l=s(69835),o=s(53536),d=s(70579);const c=e=>Math.ceil(e/Math.pow(1024,2)),h={"file-too-large":"File is larger than allowed size of 5mb"};function u(e){let{fileRejections:t}=e;return(0,d.jsx)(i.A,{variant:"outlined",sx:{py:1,px:2,mt:1,borderColor:"error.light",bgcolor:e=>(0,a.X4)(e.palette.error.main,.08)},children:t.map((e=>{let{file:t,errors:s}=e;const{path:a,size:i}=(0,l.W)(t);return(0,d.jsxs)(n.A,{sx:{my:1},children:[(0,d.jsxs)(r.A,{variant:"subtitle2",noWrap:!0,children:[a,i?` - ${c(i)}mb`:""]}),s.map((e=>{const t=o.get(h,e.code)||e.message;return(0,d.jsx)(n.A,{component:"li",sx:{typography:"caption"},children:t},e.code)}))]},a)}))})}},669:(e,t,s)=>{s.r(t),s.d(t,{default:()=>R});var a=s(89379),i=s(65043);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 708c-22.1 0-40-17.9-40-40s17.9-40 40-40 40 17.9 40 40-17.9 40-40 40zm62.9-219.5a48.3 48.3 0 00-30.9 44.8V620c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8v-21.5c0-23.1 6.7-45.9 19.9-64.9 12.9-18.6 30.9-32.8 52.1-40.9 34-13.1 56-41.6 56-72.7 0-44.1-43.1-80-96-80s-96 35.9-96 80v7.6c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V420c0-39.3 17.2-76 48.4-103.3C430.4 290.4 470 276 512 276s81.6 14.5 111.6 40.7C654.8 344 672 380.7 672 420c0 57.8-38.1 109.8-97.1 132.5z"}}]},name:"question-circle",theme:"filled"};var r=s(8436),l=function(e,t){return i.createElement(r.A,(0,a.A)((0,a.A)({},e),{},{ref:t,icon:n}))};const o=i.forwardRef(l);var d=s(68903),c=s(67254),h=s(81e3),u=s(85865),m=s(42518),f=s(79226),v=s(73012),p=s(29609),x=s(97508),y=s(73216),A=s(34150),g=s(8387),j=s(92073),w=s(53536),b=s(61376),z=s(69835),$=s(79074),S=s(35251),k=s(31694),E=s(43482),C=s(98612),_=s(59507),M=s(70579);const R=()=>{const e=(0,x.d4)((e=>{var t,s;return null===e||void 0===e||null===(t=e.dataset)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.data})),[t,s]=(0,i.useState)(),[a,n]=(0,i.useState)(),[r,l]=(0,i.useState)(!1),R=(0,x.wA)(),F=(0,y.g)(),[D,P]=(0,i.useState)(null),{datasetId:I}=F,[W,H]=(0,i.useState)(`${I}`);(0,i.useEffect)((()=>{R((0,E.U)({data:{filters:{status:[_.Zs.Live,_.Zs.Retired]}}}))}),[]),(0,i.useEffect)((()=>{e&&w.forEach(e,(e=>{w.get(e,"dataset_id")==I&&H(w.get(e,"name")||I)}))}),[e]);const O=async e=>{try{l(!0);const t=await(0,A.oy)(I,e);if(null===t||void 0===t||!t.data)throw new Error("");R((0,g.kX)({message:"Events pushed successfully."}))}catch(t){R((0,g.z3)({message:"Failed to push events. Please try again later"}))}finally{L(),l(!1)}},B=async()=>{const s=w.find(e,(e=>(null===e||void 0===e?void 0:e.dataset_id)===I));if(!s)return void R((0,g.z3)({message:"Invalid Dataset"}));const a=w.get(s,["extraction_config","extraction_key"])||null,i=w.get(s,["extraction_config","batch_id"])||"id";let n={};if(a){const e=Array.isArray(t)?t:[t];n={data:{[i]:(0,j.A)(),[a]:e}},O(n)}else Array.isArray(t)?(n=w.map(t,(e=>({data:{id:(0,j.A)(),event:e}}))),await(async e=>{try{l(!0);const t=w.chunk(w.map(e,(e=>(0,A.oy)(I,e))),6),s=await Promise.allSettled(w.flatten(t));let a=0,i=0;for(const e of w.flatten(s))"fulfilled"===e.status?i++:a++;R(0!==i&&0!==a?(0,g.$e)({message:`Successfully pushed ${i} events. Failed to push ${a} events`}):0===i?(0,g.z3)({message:"Failed to push events"}):(0,g.kX)({message:"Events pushed successfully."}))}catch(t){R((0,g.z3)({message:"Failed to push events. Please try again later"}))}finally{L(),l(!1)}})(n)):(n={data:{id:(0,j.A)(),event:t}},O(n))},L=()=>{n(null),s(null)};return(0,M.jsxs)(M.Fragment,{children:[r&&(0,M.jsx)(C.A,{}),(0,M.jsx)(f.A,{title:`Add Events to Dataset (${w.capitalize(W)})`,children:(0,M.jsxs)(d.Ay,{container:!0,spacing:1,children:[(0,M.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,M.jsx)(c.A,{color:"info",icon:(0,M.jsx)(o,{}),children:"Submit your events to the Datasource by uploading a JSON file or editing JSON data."})}),(0,M.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,M.jsx)(p.A,{data:t,setData:s,files:a,setFiles:n,subscribeErrors:P})})]})}),a&&w.size(a)>0&&(0,M.jsxs)(b.s,{elevation:1,children:[(0,M.jsxs)(h.A,{display:"flex",justifyContent:"space-between",children:[(0,M.jsx)(u.A,{variant:"h5",gutterBottom:!0,children:"Files Uploaded"}),(0,M.jsx)(m.A,{onClick:L,children:"Remove all"})]}),(0,M.jsx)(z.A,{files:a,showList:!1,onRemove:async e=>{const t=a&&a.filter((t=>t!==e)),i=await Promise.all(t.map((e=>(0,$.lb)(e)))),r=(l=i,w.filter(w.flattenDeep(l),(e=>!w.isEmpty(e))));var l;0===w.size(r)?(n(t),s(r),w.isEmpty(t)||R((0,g.z3)({message:"Invalid file contents"}))):(n(t),s(r))}})]}),(null===D||void 0===D?void 0:D.length)>0&&(0,M.jsx)(k.Ay,{fileRejections:D}),(0,M.jsx)(h.A,{display:"flex",justifyContent:"flex-end",children:(0,M.jsx)(S.A,{children:(0,M.jsx)(m.A,{"data-edataid":`${v.create_events}${F.datasetName}`,"data-objectid":F.datasetId,"data-objecttype":"dataset",disabled:!!w.isEmpty(t)||r,variant:"contained",sx:{my:2,ml:1},onClick:e=>B(),children:"Send Events"})})})]})}},61966:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(89379),i=s(65043);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};var r=s(8436),l=function(e,t){return i.createElement(r.A,(0,a.A)((0,a.A)({},e),{},{ref:t,icon:n}))};const o=i.forwardRef(l)}}]);
//# sourceMappingURL=669.1e338304.chunk.js.map