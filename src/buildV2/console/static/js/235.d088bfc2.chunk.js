"use strict";(self.webpackChunksunbird_obsrv=self.webpackChunksunbird_obsrv||[]).push([[235],{1195:(e,t,a)=>{a.d(t,{A:()=>x});var i=a(83462),n=a(98533),s=a(42518),r=a(81e3),l=a(4219),d=a(35316),o=a(29347),c=a(73012),h=a(70579);const x=e=>{let{handleClose:t,action:a=null,open:x=!1,context:m={}}=e;return m.show=void 0===m.show||m.show,(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(i.A,{open:x,onClose:t,children:(0,h.jsxs)(r.A,{sx:{p:1,py:1.5},children:[(0,h.jsx)(l.A,{children:null===m||void 0===m?void 0:m.title}),(0,h.jsxs)(d.A,{children:[(0,h.jsx)(n.A,{children:null===m||void 0===m?void 0:m.content}),null===m||void 0===m?void 0:m.component]}),!0===m.show&&(0,h.jsxs)(o.A,{children:[(0,h.jsx)(s.A,{"data-edataid":c.alert_dialog_cancel,color:"error",onClick:e=>t(),children:"Cancel"}),(0,h.jsx)(s.A,{"data-edataid":c.alert_dialog_agree,variant:"contained",onClick:()=>{a&&a(),t(!0)},autoFocus:!0,children:"Agree"})]})]})})})}},57284:(e,t,a)=>{a.d(t,{A:()=>B,E:()=>R});var i=a(61966),n=a(81e3),s=a(85865),r=a(68903),l=a(74600),d=a(23592),o=a(79226),c=a(8248),h=a(65043),x=a(15813),m=a(83462),p=a(71612),u=a(4219),j=a(17392),g=a(35316),v=a(29347),A=a(28627),y=a(53536),f=a(97508),b=a(73012),_=a(73033),k=a(11582),C=a(85260),D=a(79074),S=a(70579);const w=e=>{const{onClose:t,setSelection:a,persistState:i,masterDatasets:r=[]}=e,[d,o]=(0,h.useState)({}),c=(0,f.d4)((e=>null===e||void 0===e?void 0:e.wizard)),x=(0,f.d4)((e=>{var t;return(null===e||void 0===e||null===(t=e.config)||void 0===t?void 0:t.validationLimit)||{}})),m=y.get(c,"pages.columns.state.schema")||[],[w,F]=(0,h.useState)(null),[I,T]=(0,h.useState)(!0);(0,h.useEffect)((()=>{y.isEmpty(d)||T(y.keys(w).length>0)}),[d]);const M=y.map(m,(e=>{const t=y.get(e,"column");return{label:t,value:t,type:y.get(e,"type")}})),z=[{name:"denorm_key",label:"Dataset Field",type:"autocomplete",required:!0,selectOptions:y.filter(M,(e=>"string"===e.type))},{name:"dataset_id",label:"Master Dataset",type:"select",required:!0,selectOptions:y.map(r,(e=>({label:y.get(e,"name"),value:y.get(e,"dataset_id")})))},{name:"denorm_out_field",label:"Input Field (to store the data)",type:"text",required:!0}],W=_.Ik().shape({denorm_key:_.Yj().required(C.isRequired),dataset_id:_.Yj().required(C.isRequired),denorm_out_field:_.Yj().required(C.isRequired).trim(C.whiteSpaceConflict).strict(!0).max(y.get(x,["denormInputFieldMaxLen"])).test("specialChars",C.hasSpecialCharacters,(e=>!(0,D.e3)(e)))}),E=async e=>{const t=(e=>{const{dataset_id:t}=e,a=y.find(r,(e=>y.get(e,"dataset_id")===t)),i=y.get(a,"dataset_id"),n=y.get(a,"name");return{...e,...i&&{dataset_id:i,dataset_name:n}}})(e);a((e=>{const a=[...e,t];return i({payload:a,newData:t}),a}))};return(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(n.A,{sx:{p:1,py:1.5,width:"50vw",maxWidth:"100%",height:"auto"},children:[(0,S.jsxs)(u.A,{component:n.A,display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,S.jsx)(s.A,{variant:"h5",children:"Add Denorm Field"}),t?(0,S.jsx)(j.A,{"aria-label":"close",onClick:t,sx:{color:e=>e.palette.grey[500]},children:(0,S.jsx)(p.A,{})}):null]}),(0,S.jsx)(g.A,{children:(0,S.jsx)(l.A,{spacing:2,my:1,children:(0,S.jsx)(A.A,{initialValues:{},subscribe:o,onSubmit:e=>{},fields:z,size:{xs:12},validationSchema:W,subscribeErrors:F})})}),(0,S.jsx)(v.A,{sx:{px:4},children:(0,S.jsx)(k.m,{"data-edataid":b.add_dataset_denorm_field,"data-objectid":d,"data-objecttype":"masterDataset",variant:"contained",disabled:I,onClick:e=>(async()=>{if(!(y.keys(w).length>0))return y.size(d)===z.length?(await E(d),void t()):void 0})(),size:"large",sx:{width:"auto"},children:(0,S.jsx)(s.A,{variant:"h5",children:"Add Field"})})})]})})};var F=a(85976),I=a(21945),T=a(73216),M=a(34150),z=a(98612),W=a(59507);const{spacing:E}=x.A,R=e=>y.filter(e,(e=>y.get(e,"type")===W.DE.MasterDataset&&[W.Zs.Live].includes(y.get(e,"status")))),O=e=>{const t=y.filter(e,(e=>y.get(e,"type")===W.DE.MasterDataset&&[W.Zs.Live].includes(y.get(e,"status"))));return t.length>0?{redis_db_host:y.get(t,"[0].denorm_config.redis_db_host"),redis_db_port:y.get(t,"[0].denorm_config.redis_db_port")}:{redis_db_host:"",redis_db_port:""}},B=e=>{const t=(0,f.wA)(),{description:a,id:x}=e,p=(0,f.d4)((e=>y.get(e,"dataset.data.data")||[])),u=R(p),[j,g]=(0,h.useState)(y.size(u)>0),[v,A]=(0,h.useState)(!1),_=(0,f.d4)((e=>y.get(e,["wizard","pages",x,"values"]))),[C,D]=((0,f.d4)((e=>y.get(e,["wizard","pages","datasetConfiguration","state","config","dataset_id"]))),(0,h.useState)(_||[])),[W,B]=(0,h.useState)(!1),N=(0,T.Zp)(),q=async e=>{const{payload:t,metadata:a}=e;D(t),K({payload:t,metadata:a})},K=e=>{const{payload:a,newData:i,metadata:n}=e,s=O(p);(0,M.y7)({denormFields:i,denormMetadata:n}),t((0,I.FA)({id:x,...s,values:a}))};(0,h.useEffect)((()=>{_&&D([..._])}),[_]);const L=[{Header:"Dataset Field",accessor:"denorm_key"},{Header:"Master Dataset",accessor:"redis_db",Cell:e=>{let{value:t,cell:a}=e;const i=y.get(a,"row.original.dataset_id");return(0,S.jsx)(n.A,{children:(0,S.jsx)(s.A,{children:i})})}},{Header:"Input Field (to store the data)",accessor:"denorm_out_field"},{Header:"Delete",Cell:e=>{let{value:t,cell:a}=e;return(0,S.jsx)(F.A,{"data-edataid":`${b.delete_daatset_denorm}:master`,"data-objectid":"deleteOutlined:masterDataset","data-objecttype":"masterDataset",size:"large",onClick:e=>(async e=>{const t=C.filter((t=>y.get(t,"denorm_out_field")!==y.get(e,"denorm_out_field")));await q({payload:t,metadata:e})})(y.get(a,"row.original")),children:(0,S.jsx)(i.A,{style:{fontSize:"1.25rem"}})})}}],$=()=>{N("/dataset/new/master?master=true",{state:{replace:!0,refreshMaster:!0}})};return(0,S.jsxs)(S.Fragment,{children:[W&&(0,S.jsx)(z.A,{}),(0,S.jsx)(r.Ay,{container:!0,rowSpacing:E,children:j?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(r.Ay,{item:!0,xs:12,children:(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(o.A,{content:!1,headerSX:{},children:(0,S.jsx)(c.A,{children:(0,S.jsx)(d.A,{columns:L,data:C,striped:!0,styles:{"&.MuiTableCell-root":{border:"1px solid #D9D9D9"}}})})})})}),(0,S.jsx)(r.Ay,{item:!0,xs:12,children:(0,S.jsxs)(l.A,{spacing:E,direction:"row",justifyContent:"flex-end",my:2,children:[(0,S.jsx)(n.A,{children:(0,S.jsx)(k.m,{"data-edataid":`${b.add_dataset_denorm_field}:master`,"data-objectid":"addDenormField","data-objecttype":"masterDataset",variant:"contained",size:"large",onClick:e=>A(!0),sx:{width:"auto"},children:(0,S.jsx)(s.A,{variant:"h5",children:"Add Denorm Field"})})}),(0,S.jsx)(n.A,{children:(0,S.jsx)(k.m,{"data-edataid":`${b.add_dataset_denorm}:master`,"data-objectid":"createMasterDataset","data-objecttype":"masterDataset",onClick:e=>$(),sx:{width:"auto"},children:(0,S.jsx)(s.A,{variant:"h5",children:"Create New Master Dataset"})})})]})}),(0,S.jsx)(r.Ay,{item:!0,xs:12,children:(0,S.jsx)(m.A,{open:v,onClose:e=>A(!1),children:(0,S.jsx)(w,{selection:C,setSelection:D,onClose:()=>A(!1),persistState:K,masterDatasets:u,redisConfig:O(p)})})})]}):(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(r.Ay,{item:!0,xs:12,children:(0,S.jsxs)(l.A,{spacing:E,direction:"column",justifyContent:"center",alignItems:"center",children:[(0,S.jsx)(s.A,{variant:"body1",fontWeight:500,children:"There are no master datasets configured in the system. Please create one to setup data denormalization for the dataset."}),(0,S.jsx)(n.A,{children:(0,S.jsx)(k.m,{"data-edataid":`${b.add_dataset_denorm}:master`,"data-objectid":"createMasterDataset","data-objecttype":"masterDataset",onClick:e=>$(),variant:"contained",size:"large",sx:{width:"auto"},children:(0,S.jsx)(s.A,{variant:"h5",children:"Create Master Dataset"})})})]})})})})]})}},85041:(e,t,a)=>{a.d(t,{A:()=>re});var i=a(37538),n=a(79650),s=a(71806),r=a(84882),l=a(28076),d=a(10039),o=a(73460),c=a(69392),h=a(68903),x=a(67254),m=a(53536),p=a.n(m),u=a(40230),j=a(95240),g=a(70579);const v=e=>{const{datasetState:t}=e,a=m.get(t,["pages","transform","selection"])||[],i=m.get(t,["pages","derived","selection"])||[],p=[...m.get(t,["pages","pii","selection"])||[],...a,...i],v=[{id:"transformations",title:"Transformations",data:p}],A=(e,t,a)=>(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(n.A,{children:(0,g.jsxs)(s.A,{size:"small",children:[(0,g.jsx)(r.A,{sx:{bgcolor:"unset"},children:(0,g.jsx)(l.A,{children:[{id:"column",label:"Field"},{id:"_transformationType",label:"Transformation"},{id:"transformation_mode",label:"Mode"}].map((e=>(0,g.jsx)(d.A,{sx:{"&.MuiTableCell-root":{border:"1px solid #D9D9D9"}},children:e.label},e.id)))})}),(0,g.jsx)(o.A,{children:t.map((e=>(0,g.jsx)(l.A,{children:[{id:"column",label:"Field"},{id:"_transformationType",label:"Transformation"},{id:"transformation_mode",label:"Mode"}].map((t=>"_transformationType"===t.id&&"custom"===e[t.id]?(0,g.jsx)(d.A,{sx:{"&.MuiTableCell-root":{border:"1px solid #D9D9D9"},maxWidth:200},children:(0,g.jsx)(c.A,{title:e.transformation,children:(0,g.jsx)(u.O,{variant:"body2",sx:{maxWidth:"60%"},children:e.transformation})})},e.id):(0,g.jsx)(d.A,{sx:{"&.MuiTableCell-root":{border:"1px solid #D9D9D9"},maxWidth:250},children:(0,g.jsx)(c.A,{title:e[t.id],children:(0,g.jsx)(u.O,{variant:"body2",sx:{maxWidth:"70%"},children:e[t.id]})})},e.id)))})))})]})})});return p.length>0?(0,g.jsx)(g.Fragment,{children:v.length>0&&(0,g.jsx)(h.Ay,{container:!0,columnSpacing:1,rowSpacing:1,children:v.map((e=>{let{title:t,data:a,id:i}=e;return m.size(a)>0?(0,g.jsx)(h.Ay,{item:!0,xs:12,sm:12,md:12,lg:12,children:A(0,a)}):null}))})}):(0,g.jsx)(x.A,{color:"error",icon:(0,g.jsx)(j.A,{}),children:"No information to display"})};var A=a(85865),y=a(34150),f=a(13383);const b=e=>{const{datasetState:t}=e,a=m.get(t,["pages","timestamp","indexCol"]),i=a==y.R8.indexValue?"Event Arrival Time":a;return i?(0,g.jsx)(g.Fragment,{children:i&&(0,g.jsxs)(A.A,{variant:"h6",display:"flex",alignItems:"center",children:[(0,g.jsx)(f.A,{color:"secondary",sx:{fontSize:"1.25rem",mr:1}}),"Timestamp Field : ",(0,g.jsx)(A.A,{variant:"h6",fontWeight:400,ml:1,children:i})]})}):(0,g.jsx)(x.A,{color:"error",icon:(0,g.jsx)(j.A,{}),children:"No information to display"})};var _=a(65043),k=a(90889),C=a(86605),D=a(40710),S=a(79074),w=a(79226),F=a(51544),I=a(23592),T=a(36910),M=a(59506),z=a(81e3),W=a(74600),E=a(42518),R=a(92073);const O=e=>{let{datasetId:t,configuredBatchId:a,configuredBatchKey:i,isBatch:n=!1}=e;const s={true:[`curl --location '{{api-host}}/data/v1/in/${t}'`," --header 'Content-Type: application/json'",` --data '{"data": {"${a}": "${(0,R.A)()}" ,"${i}": [{}]}}'`],false:[`curl --location '{{api-host}}/data/v1/in/${t}'`," --header 'Content-Type: application/json'",' --data \'{"data": {"event": {}}}\'']};return p().get(s,`${n}`)||[]},B=e=>{const{datasetId:t,dataFormatConfig:a}=e,[i,n]=(0,_.useState)("Copy"),s="yes"===p().lowerCase(p().get(a,["value","type"]))||!1,r=s&&p().get(a,["value","batchId"])||null,l=s?p().get(a,["value","extractionKey"])||"id":null;return(0,g.jsx)(z.A,{sx:{bgcolor:"secondary.100"},children:(0,g.jsx)(h.Ay,{container:!0,children:(0,g.jsx)(h.Ay,{item:!0,xs:12,m:1,children:(0,g.jsxs)(W.A,{direction:"row",justifyContent:"space-between",children:[(0,g.jsx)(h.Ay,{item:!0,ml:1,sx:{display:"flex",flexDirection:"column"},children:p().map(O({datasetId:t,configuredBatchId:r,configuredBatchKey:l,isBatch:s}),(e=>(0,g.jsx)(A.A,{variant:"caption",fontSize:14,children:e})))}),(0,g.jsx)(h.Ay,{item:!0,textAlign:"center",mr:1,children:(0,g.jsx)(c.A,{title:i,children:(0,g.jsx)(E.A,{color:"secondary",size:"medium",endIcon:"Copy"===i?(0,g.jsx)(T.A,{}):(0,g.jsx)(M.A,{}),onClick:()=>{navigator.clipboard.writeText(O({datasetId:t,configuredBatchId:r,configuredBatchKey:l,isBatch:s}).join(encodeURIComponent(""))||""),n("Copied")},variant:"dashed",children:i})})})]})})})})},N=e=>{const{datasetState:t}=e,a=m.get(t,["pages","dataSource"]),[i,n]=(0,_.useState)("panel1"),s=m.get(t,["pages","datasetConfiguration","state","config","dataset_id"])||"",r=m.get(t,["pages","dataFormat"]);return a?(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(g.Fragment,{children:m.map(a.formFieldSelection,(e=>{if("kafka-connector-1.0.0"!==e&&"api"!==e)return null;const t=m.get(a,["value",e])||{},l=m.omit(t,["connector_type","authenticationMechanism","id","prefix","fileFormat.compressed"]),d=(0,S.YO)(l)||[],o=[{Header:()=>null,accessor:"key",disableFilters:!0,Cell:e=>{const t=m.get(e,["cell","row","original"])||{},{key:a,value:i}=t;return(0,g.jsx)(A.A,{variant:"body1",fontWeight:500,children:m.capitalize((0,F.I)(a))})}},{Header:()=>null,accessor:"value",disableFilters:!0,Cell:e=>{const t=m.get(e,["cell","row","original"])||{},{key:a,value:i}=t;return(0,g.jsx)(A.A,{sx:{minWidth:"20vw",maxWidth:"25vw"},children:i})}}];return(0,g.jsxs)(k.A,{expanded:i===e,onChange:(c=e,(e,t)=>{n(!!t&&c)}),children:[(0,g.jsx)(C.A,{"aria-controls":"panel1d-content",id:"panel1d-header",children:(0,g.jsx)(A.A,{children:m.toUpper((0,F.I)(e))})}),(0,g.jsx)(D.A,{children:(0,g.jsx)(h.Ay,{container:!0,children:(0,g.jsx)(h.Ay,{item:!0,xs:12,children:(0,g.jsxs)(w.A,{content:!1,children:["api"==e&&(0,g.jsx)(B,{datasetId:s,dataFormatConfig:r}),!m.isEmpty(d)&&(0,g.jsx)(I.A,{data:d,columns:o,header:null})]})})})})]});var c}))})}):(0,g.jsx)(x.A,{color:"error",icon:(0,g.jsx)(j.A,{}),children:"No information to display"})};var q=a(51962);const K=e=>{const{datasetState:t}=e,a=m.get(t,["pages","dataFormat"]),i=[{id:"extractionKey",label:"Extraction Key"},{id:"batchId",label:"Batch ID"},{id:"dedupeRequired",label:"Dedup Required"},{id:"dedupePeriod",label:"Dedup Period"}];return a?(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(h.Ay,{container:!0,display:"flex",flexDirection:"column",children:[(0,g.jsx)(h.Ay,{item:!0,xs:4,children:(0,g.jsxs)(z.A,{display:"flex",alignItems:"center",children:[(0,g.jsx)(q.A,{checked:!0,onChange:()=>{}}),(0,g.jsx)(A.A,{variant:"h6",fontWeight:400,children:"Individual Events"})]})}),"yes"===m.lowerCase(a.value.type)&&(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(h.Ay,{item:!0,xs:8,children:(0,g.jsxs)(h.Ay,{container:!0,display:"flex",flexDirection:"column",children:[(0,g.jsx)(h.Ay,{item:!0,xs:3,children:(0,g.jsxs)(z.A,{display:"flex",alignItems:"center",children:[(0,g.jsx)(q.A,{checked:!0,onChange:()=>{}}),(0,g.jsx)(A.A,{variant:"h6",fontWeight:400,children:"Batch Mode"})]})}),(0,g.jsx)(h.Ay,{item:!0,xs:12,pl:4.4,children:(0,g.jsxs)(W.A,{direction:"column",spacing:1,children:[(0,g.jsxs)(A.A,{variant:"body1",display:"flex",alignItems:"center",children:[(0,g.jsx)(f.A,{color:"secondary",sx:{fontSize:"1.25rem",mr:1}}),"Extraction Key : ",(0,g.jsx)(A.A,{variant:"body1",ml:1,children:a.value[i[0].id]})]}),(0,g.jsxs)(A.A,{variant:"body1",display:"flex",alignItems:"center",children:[(0,g.jsx)(f.A,{color:"secondary",sx:{fontSize:"1.25rem",mr:1}}),"Batch Identifier : ",(0,g.jsx)(A.A,{variant:"body1",ml:1,children:a.value[i[1].id]})]})]})})]})})})]})})}):(0,g.jsx)(x.A,{color:"error",icon:(0,g.jsx)(j.A,{}),children:"No information to display"})},L=e=>{const{datasetState:t}=e,a=m.get(t,["pages","dataValidation","formFieldSelection"]);return a?(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(h.Ay,{container:!0,children:(0,g.jsx)(h.Ay,{item:!0,xs:12,display:{xs:"block",sm:"flex"},children:a&&(0,g.jsx)(z.A,{mr:2,children:(0,g.jsxs)(A.A,{variant:"h6",display:"flex",alignItems:"center",children:[(0,g.jsx)(f.A,{color:"secondary",sx:{fontSize:"1.25rem",mr:1}}),"Data Validation : ",(0,g.jsx)(A.A,{variant:"h6",fontWeight:400,ml:1,children:a})]})})})})}):(0,g.jsx)(x.A,{color:"error",icon:(0,g.jsx)(j.A,{}),children:"No information to display"})},$=e=>{const{datasetState:t}=e,a=m.get(t,["pages","dedupe","optionSelection","dedupeKey"]);return a?(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(h.Ay,{container:!0,children:(0,g.jsx)(h.Ay,{item:!0,xs:12,display:{xs:"block",sm:"flex"},children:a&&(0,g.jsx)(z.A,{mr:2,children:(0,g.jsxs)(A.A,{variant:"h6",display:"flex",alignItems:"center",children:[(0,g.jsx)(f.A,{color:"secondary",sx:{fontSize:"1.25rem",mr:1}}),"Dedup Field : ",(0,g.jsx)(A.A,{variant:"h6",fontWeight:400,ml:1,children:a})]})})})})}):(0,g.jsx)(x.A,{color:"error",icon:(0,g.jsx)(j.A,{}),children:"No information to display"})},P=e=>{const{datasetState:t}=e,a=m.get(t,["pages","dataKey"]);return a?(0,g.jsx)(g.Fragment,{children:a&&(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(h.Ay,{container:!0,children:(0,g.jsx)(h.Ay,{item:!0,xs:4,children:(0,g.jsx)(z.A,{display:"flex",alignItems:"center",children:(0,g.jsxs)(A.A,{variant:"body1",display:"flex",alignItems:"center",children:[(0,g.jsx)(f.A,{color:"secondary",sx:{fontSize:"1.25rem",mr:1}}),"Data Key : ",(0,g.jsx)(A.A,{variant:"body1",ml:1,children:m.get(a,"dataKey")})]})})})})})}):(0,g.jsx)(x.A,{color:"error",icon:(0,g.jsx)(j.A,{}),children:"No information to display"})};var H=a(97508),U=a(57284);const V=e=>{const{datasetState:t}=e,a=(0,H.d4)((e=>m.get(e,"dataset.data.data")||[])),i=m.get(t,["pages","denorm","values"]),p=(0,U.E)(a),v=e=>m.find(p,["dataset_config.cache_config.redis_db",e]),A={denorm_key:"Dataset Field",dataset_id:"Master Dataset",denorm_out_field:"New Field Name"};return m.isEmpty(i)?(0,g.jsx)(x.A,{color:"error",icon:(0,g.jsx)(j.A,{}),children:"No information to display"}):(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(h.Ay,{container:!0,children:m.size(i)>0&&(0,g.jsx)(h.Ay,{item:!0,xs:12,sm:12,md:12,lg:12,children:(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(n.A,{children:(0,g.jsxs)(s.A,{size:"small",children:[(0,g.jsx)(r.A,{sx:{bgcolor:"unset"},children:(0,g.jsx)(l.A,{children:Object.values(A).map(((e,t)=>(0,g.jsx)(d.A,{sx:{"&.MuiTableCell-root":{border:"1px solid #D9D9D9"}},children:e},t)))})}),(0,g.jsx)(o.A,{children:i.map((e=>{var t,a,i;e={denorm_key:null===(t=e)||void 0===t?void 0:t.denorm_key,dataset_id:null===(a=e)||void 0===a?void 0:a.dataset_id,denorm_out_field:null===(i=e)||void 0===i?void 0:i.denorm_out_field};const n=m.find(p,(t=>m.get(t,"dataset_id")===m.get(e,"dataset_id"))),s=m.get(n,"name");return(0,g.jsx)(l.A,{children:Object.entries(e).map((e=>{var t;let[a,i]=e;return(0,g.jsx)(d.A,{sx:{"&.MuiTableCell-root":{border:"1px solid #D9D9D9"},maxWidth:250},children:(0,g.jsx)(c.A,{title:"dataset_id"===a?null===(t=v(i))||void 0===t?void 0:t.name:i,children:(0,g.jsx)(u.O,{variant:"body2",sx:{maxWidth:"70%"},children:"dataset_id"===a?s:i})})},a)}))})}))})]})})})})})})};var Y=a(7277),Z=a(21337),Q=a(91707),J=a(28912),X=a(29059),G=a(26240),ee=a(49777),te=a(21945),ae=a(70532);const ie=e=>{const{datasetState:t}=e,a=(0,H.wA)(),[i,n]=(0,_.useState)([]),[s,r]=(0,_.useState)(!1),l=(0,H.d4)((e=>null===e||void 0===e?void 0:e.wizard)),d=p().isEmpty(t)?l:t,o=p().get(d,"pages.jsonSchema.schema"),c=(p().get(d,"pages.jsonSchema.dataMappings"),(0,G.A)());(0,_.useEffect)((()=>{(async()=>{r(!0);try{var e,a,i,s;const r=p().get(d,"pages.status"),l=await(0,y.jE)(null===t||void 0===t||null===(e=t.pages)||void 0===e||null===(a=e.datasetConfiguration)||void 0===a||null===(i=a.state)||void 0===i||null===(s=i.config)||void 0===s?void 0:s.dataset_id,r),o=(null===l||void 0===l?void 0:l.data[0])||[];n(o)}catch(l){console.log(l)}finally{r(!1)}})()}),[]);const x=e=>a((0,te.FA)({id:"ingestion.spec.id",state:{schema:e||i},error:!(0,ee.oL)(e||i)})),m=(0,_.useMemo)((()=>[{Header:()=>null,id:"expander",className:"cell-center",tipText:"",editable:!1,Cell:e=>{let{row:t}=e;const a=t.isExpanded?(0,g.jsx)(Z.A,{}):(0,g.jsx)(Q.A,{});return t.canExpand&&0===t.depth&&(0,g.jsx)(z.A,{sx:{fontSize:"1rem"},...t.getToggleRowExpandedProps(),children:a})},SubCell:()=>null},{Header:"Field",accessor:"column",tipText:"Name of the field.",editable:!1,Filter:J.ev,isReadOnly:!0,filter:"includes",Cell:e=>{let{value:t,cell:a}=e;const[i,s]=(0,_.useState)(!1),[r,l]=(0,_.useState)("");return(0,X.PO)({cell:a,value:t,persistState:x,setFlattenedData:n,theme:c,text:r,setText:l,edit:i,setEdit:s,disabled:!0})}},{Header:"Data type",accessor:"data_type",tipText:"Data type of the field",errorBg:!0,editable:!1,isReadOnly:!0,Filter:J.ev,filter:"includes",Cell:e=>{let{value:t,cell:a,row:i}=e;const n=p().get(i,"original._transformedFieldDataType")||p().get(i,"original.data_type");return(0,g.jsx)(z.A,{px:2,children:(0,g.jsx)(A.A,{variant:"h6",children:n})})}}]),[]);return(0,g.jsx)(h.Ay,{item:!0,xs:12,sm:12,children:s?(0,ae.Y)({config:{type:"table",width:"100%"}}):(0,g.jsx)(Y.A,{columns:m,data:(0,ee.v2)(i,o),updateMyData:()=>{},skipPageReset:()=>{},limitHeight:!0,tHeadHeight:52,showSearchBar:!1,styles:{"&.MuiTableCell-root":{border:"1px solid #D9D9D9"}}})})};var ne=a(74865),se=a(89330);const re=e=>{let{master:t,datasetState:a}=e;const n=(0,H.d4)((e=>null===e||void 0===e?void 0:e.wizard)),s=m.isEmpty(a)?n:a,r=m.get(s,"pages.jsonSchema"),l=m.get(s,["pages","columns","state","schema"]);let d=[{id:"datakey",title:"Data key",description:"Details about data key",component:(0,g.jsx)(P,{datasetState:s}),master:!0,dataset:!1,componentType:"box"},{id:"dataFormat",title:"Data formats",description:"Details about data formats",component:(0,g.jsx)(K,{datasetState:s}),master:!0,dataset:!0,componentType:"box"},{id:"validation",title:"Validation",description:"Details about validation",component:(0,g.jsx)(L,{datasetState:s}),dataset:!0,componentType:"box"},{id:"timestamp",title:"Timestamp",description:"Details about timestamp filed",component:(0,g.jsx)(b,{datasetState:s}),dataset:!0,componentType:"box"},{id:"dedup",title:"Deduplication",description:"Details about deduplication",component:(0,g.jsx)($,{datasetState:s}),dataset:!0,componentType:"box"},{id:"dataSource",title:"Data source",description:"Details about data sources",component:(0,g.jsx)(N,{datasetState:s}),master:!0,dataset:!0},{id:"dataschema",title:"Data schema",description:"Details about data schema",component:(0,g.jsx)(ie,{datasetState:s}),master:!0,dataset:!0},{id:"transformations",title:"Transformations",description:"Details about transformations",component:(0,g.jsx)(v,{datasetState:s}),master:!0,dataset:!0},{id:"denorm",title:"Denormalization",description:"Details about Denormalization",component:(0,g.jsx)(V,{datasetState:s}),dataset:!0}];d=t?m.filter(d,["master",!0]):m.filter(d,["dataset",!0]);const o=[{label:"Download Schema",value:"downloadSchema",onClick:()=>{let e=m.get(r,"schema");l&&(e=m.get((0,ee.Mt)(r,{schema:l}),"schema")),(0,ne.z)(e,"json-schema",!0)},icon:(0,g.jsx)(se.A,{}),disabled:!1,display:!0}];return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(h.Ay,{container:!0,spacing:1,children:[(0,g.jsx)(h.Ay,{item:!0,xs:12,children:(0,g.jsx)(W.A,{direction:"row",spacing:1,justifyContent:"flex-end",children:m.map(o,(e=>{const{label:t,value:a,onClick:i,icon:n,disabled:s,display:r}=e;return r?(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(E.A,{variant:"contained",size:"large",type:"button",onClick:i,startIcon:n,disabled:s,children:(0,g.jsx)(A.A,{variant:"body1",children:t})},a)}):null}))})}),(0,g.jsx)(h.Ay,{item:!0,xs:12})]}),(0,i.H1)({sections:d})]})}},29059:(e,t,a)=>{a.d(t,{ot:()=>R,xY:()=>O,PO:()=>z,zz:()=>W,m4:()=>E});a(65043);var i=a(81e3),n=a(85865),s=a(42518),r=a(83462),l=a(4219),d=a(35316),o=a(69392),c=a(30802),h=a(53193),x=a(72221),m=a(32143),p=a(41020),u=a(74605),j=a(74600),g=a(17392),v=a(34535),A=a(4598);const y=(0,v.Ay)(A.A)((e=>{let{theme:t}=e;return{}}));var f=a(75337),b=a(89967),_=a(94786),k=a(63390),C=a(61966),D=a(53536),S=a(23837),w=a(40230),F=a(21337),I=a(91707),T=a(73012),M=a(70579);const z=e=>{var t;let{cell:a,setFlattenedData:h,persistState:x,value:m,theme:p,edit:u,setEdit:j,text:g,setText:v,disabled:A=!1}=e;const y=(null===a||void 0===a||null===(t=a.row)||void 0===t?void 0:t.original)||{},_=(null===a||void 0===a?void 0:a.row)||{},k=_.isExpanded?(0,M.jsx)(F.A,{sx:{ml:-1}}):(0,M.jsx)(I.A,{sx:{ml:-1}}),C=()=>{j((e=>!e))},T=()=>{h((e=>{const t={...y},a=D.map(e,(e=>D.get(e,"column")===D.get(t,"originalColumn")?{...e,...t,isModified:!0,description:g,column:D.get(t,"originalColumn")}:e));return x(a),a}))};return(0,M.jsxs)(i.A,{alignItems:"baseline",maxWidth:"30vw",minWidth:"30vw",paddingLeft:_.depth>0?3*_.depth:0,children:[(0,M.jsxs)(i.A,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,M.jsx)(S.A,{title:m,children:(0,M.jsxs)(i.A,{display:"flex",alignItems:"center",minWidth:"75%",maxWidth:"80%",children:[(null===_||void 0===_?void 0:_.canExpand)&&(null===_||void 0===_?void 0:_.depth)>0&&(0,M.jsx)(i.A,{sx:{fontSize:"1rem"},..._.getToggleRowExpandedProps(),children:k}),(0,M.jsx)(n.A,{padding:.2,variant:"h6",my:1,maxWidth:"70%",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",children:m})]})}),!y.description&&!A&&(0,M.jsx)(s.A,{sx:{fontWeight:500},onClick:C,startIcon:(0,M.jsx)(f.A,{style:{fontSize:"1.25rem",strokeWidth:25,stroke:p.palette.primary.main}}),children:"Description"})]}),y.description&&(0,M.jsx)(S.A,{title:y.description,placement:"top-start",arrow:!0,children:(0,M.jsx)(w._,{variant:"body3",color:"secondary",onClick:C,children:y.description})}),(0,M.jsxs)(r.A,{open:u,onClose:C,children:[(0,M.jsxs)(l.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,M.jsx)(S.A,{title:m,children:(0,M.jsx)(n.A,{mx:2,maxWidth:"70%",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",children:m})}),(0,M.jsx)(b.A,{onClick:C})]}),(0,M.jsxs)(d.A,{children:[(0,M.jsx)(i.A,{m:2,children:(0,M.jsx)(o.A,{title:"Add a description that must be under 300 characters",placement:"top",children:(0,M.jsx)(c.A,{minRows:3,style:{width:"31.25rem",height:"6.875rem"},autoFocus:!0,maxLength:300,defaultValue:y.description,"aria-label":"description of field",onChange:e=>{v(e.target.value)},placeholder:"Add description here..."})})}),(0,M.jsx)(i.A,{display:"flex",justifyContent:"flex-end",children:(0,M.jsx)(s.A,{sx:{my:1,mx:2,width:230},onClick:()=>{T(),j((e=>!e))},variant:"contained",children:(0,M.jsx)(n.A,{variant:"body1",fontWeight:500,children:"Save"})})})]})]})]})},W=e=>{var t;let{cell:a,value:r,pageData:l,anchorEl:d,setAnchorEl:o,updateDataType:c,persistState:u,setFlattenedData:j,resetSuggestionResolve:g,validDatatypes:v,disabled:A,dataMappings:y}=e;const f=(null===a||void 0===a||null===(t=a.row)||void 0===t?void 0:t.original)||{},b=D.get(f,"suggestions.length"),C=D.get(f,"resolved")||!1,S=Boolean(d),w=e=>{o(e.currentTarget)};return!(A||null!==f&&void 0!==f&&f.disableActions)||null!==f&&void 0!==f&&f.isModified?null!==f&&void 0!==f&&f.isModified&&null!==f&&void 0!==f&&f.isNewlyAdded&&"object"===(null===f||void 0===f?void 0:f.arrival_format)?(0,M.jsx)(i.A,{px:2,children:(0,M.jsx)(n.A,{variant:"h6",children:r})}):(0,M.jsxs)(i.A,{position:"relative",maxWidth:180,display:"block",alignItems:"center",my:1,children:[(null===f||void 0===f?void 0:f.oneof)&&!C&&!(null!==f&&void 0!==f&&f.arrivalOneOf)&&(0,M.jsx)(s.A,{startIcon:(0,M.jsx)(_.A,{}),color:"error",onClick:w,sx:{mx:1},children:(0,M.jsx)(n.A,{variant:"caption",children:"Recommended Change"})}),(null===f||void 0===f?void 0:f.oneof)&&C&&!(null!==f&&void 0!==f&&f.arrivalOneOf)&&(0,M.jsx)(s.A,{startIcon:(0,M.jsx)(k.A,{}),color:"success",onClick:w,sx:{mx:1},children:(0,M.jsx)(n.A,{variant:"caption",children:"Resolved"})}),(0,M.jsx)(h.A,{variant:"standard",sx:{mx:1,minWidth:100},children:(0,M.jsx)(x.A,{value:r,variant:"standard",children:v.map((e=>(0,M.jsx)(m.A,{onClick:()=>c(e,f,l,u,j,b,o,y),value:e,children:e},e)))})}),(0,M.jsx)(p.Ay,{open:S,anchorEl:d,onClose:()=>{o(null)},anchorOrigin:{vertical:"top",horizontal:"right"},children:(0,M.jsxs)(i.A,{p:2,maxWidth:336,children:[C&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(n.A,{variant:"h6",fontWeight:"bold",children:["Resolved",(0,M.jsxs)(n.A,{variant:"body1",my:2,children:["Data type of field ",(0,M.jsx)("strong",{children:null===f||void 0===f?void 0:f.column}),' is resolved to "',r,'"']})]}),(0,M.jsx)(i.A,{my:1,children:(0,M.jsx)(s.A,{"aria-label":"resolve-data-type",variant:"contained",onClick:()=>g(f,l,u,j,b,o),children:(0,M.jsx)(n.A,{variant:"body1",fontWeight:500,children:"Reopen Suggestion"})},`${r}-mark-resolved`)})]}),!C&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(n.A,{variant:"h6",fontWeight:"bold",children:["Must-Fix",(0,M.jsxs)(n.A,{variant:"body1",my:2,children:["The field ",(0,M.jsx)("strong",{children:null===f||void 0===f?void 0:f.column})," has multiple data type values available"]})]}),(()=>{var e;return null===f||void 0===f||null===(e=f.oneof)||void 0===e?void 0:e.map((e=>e.type!==r?(0,M.jsx)(s.A,{"aria-label":"fix-data-type",variant:"contained",sx:{my:1},onClick:()=>c(e.type,f,l,u,j,b,o,y),children:(0,M.jsx)(n.A,{variant:"body1",fontWeight:500,children:`Change Data Type to ${D.capitalize(e.type)}`})},e.type):null))})(),(null===f||void 0===f?void 0:f.data_type)&&(0,M.jsx)(i.A,{my:1,children:(0,M.jsx)(s.A,{"aria-label":"resolve-data-type",onClick:()=>c(r,f,l,u,j,b,o,y),children:(0,M.jsx)(n.A,{variant:"body1",fontWeight:500,children:"Mark as resolved"})},`${r}-mark-resolved`)})]})]})})]}):(0,M.jsx)(i.A,{px:2,children:(0,M.jsx)(n.A,{variant:"h6",children:r})})},E=e=>{var t;let{cell:a,value:n,setFlattenedData:s,persistState:r,disabled:l}=e;const d=(null===a||void 0===a||null===(t=a.row)||void 0===t?void 0:t.original)||{},o=e=>{s((t=>{const a={...d},i=D.map(t,(t=>D.get(t,"column")===D.get(a,"originalColumn")?{...t,...a,isModified:!0,required:e.target.checked,column:D.get(a,"originalColumn")}:t));return r(i),i}))};return null!==d&&void 0!==d&&d.disableActions?null:(0,M.jsx)(i.A,{display:"flex",alignItems:"center",children:(0,M.jsx)(h.A,{fullWidth:!0,sx:{alignItems:"center"},children:(0,M.jsx)(u.A,{sx:{m:"auto"},control:(0,M.jsx)(y,{size:"small",checked:n,onChange:o}),label:"",disabled:l})})})},R=e=>{var t;let{cell:a,setSelection:i,setOpenAlertDialog:n,theme:s,generateInteractTelemetry:r}=e;const l=(null===a||void 0===a||null===(t=a.row)||void 0===t?void 0:t.original)||{};return null!==l&&void 0!==l&&l.disableActions?null:(0,M.jsx)(j.A,{direction:"row",children:(0,M.jsx)(g.A,{color:"primary",size:"large",sx:{m:"auto"},onClick:()=>{r({edata:{id:T.delete_schema}}),i(l),n(!0)},children:(0,M.jsx)(C.A,{style:{color:s.palette.primary.main}})})})},O=e=>{var t;let{cell:a,value:r,pageData:l,anchorEl:d,setAnchorEl:o,updateFormatType:c,persistState:u,setFlattenedData:j,validFormatTypes:g,dataMappings:v,disabled:A,resetSuggestionResolve:y}=e;const f=(null===a||void 0===a||null===(t=a.row)||void 0===t?void 0:t.original)||{},b=D.get(f,"suggestions.length"),C=D.get(f,"resolved")||!1,S=Boolean(d),w=e=>{o(e.currentTarget)};return!(A||null!==f&&void 0!==f&&f.disableActions)||null!==f&&void 0!==f&&f.isModified?null!==f&&void 0!==f&&f.isModified&&null!==f&&void 0!==f&&f.isNewlyAdded&&"object"===(null===f||void 0===f?void 0:f.arrival_format)?(0,M.jsx)(i.A,{px:2,children:(0,M.jsx)(n.A,{variant:"h6",children:r})}):(0,M.jsxs)(i.A,{position:"relative",maxWidth:180,display:"block",alignItems:"center",my:1,children:[(null===f||void 0===f?void 0:f.arrivalOneOf)&&!C&&(0,M.jsx)(s.A,{startIcon:(0,M.jsx)(_.A,{}),color:"error",onClick:w,sx:{mx:1},children:(0,M.jsx)(n.A,{variant:"caption",children:"Recommended Change"})}),(null===f||void 0===f?void 0:f.arrivalOneOf)&&C&&(0,M.jsx)(s.A,{startIcon:(0,M.jsx)(k.A,{}),color:"success",onClick:w,sx:{mx:1},children:(0,M.jsx)(n.A,{variant:"caption",children:"Resolved"})}),(0,M.jsx)(h.A,{variant:"standard",sx:{mx:1,minWidth:120},children:(0,M.jsx)(x.A,{value:r,variant:"standard",children:g&&g.map((e=>(0,M.jsx)(m.A,{onClick:()=>c(e,f,l,u,j,v,b,o),value:e,children:e},e)))})}),(0,M.jsx)(p.Ay,{open:S,anchorEl:d,onClose:()=>{o(null)},anchorOrigin:{vertical:"top",horizontal:"right"},children:(0,M.jsxs)(i.A,{p:2,maxWidth:336,children:[C&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(n.A,{variant:"h6",fontWeight:"bold",children:["Resolved",(0,M.jsxs)(n.A,{variant:"body1",my:2,children:["Arrival Format of field ",(0,M.jsx)("strong",{children:null===f||void 0===f?void 0:f.column}),' is resolved to "',r,'"']})]}),(0,M.jsx)(i.A,{my:1,children:(0,M.jsx)(s.A,{"aria-label":"resolve-data-type",variant:"contained",onClick:()=>y(f,l,u,j,b,o),children:(0,M.jsx)(n.A,{variant:"body1",fontWeight:500,children:"Reopen Suggestion"})},`${r}-mark-resolved`)})]}),!C&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(n.A,{variant:"h6",fontWeight:"bold",children:["Must-Fix",(0,M.jsxs)(n.A,{variant:"body1",my:2,children:["The field ",(0,M.jsx)("strong",{children:null===f||void 0===f?void 0:f.column})," has multiple arrival format values available"]})]}),(()=>{var e;return null===f||void 0===f||null===(e=f.arrivalOneOf)||void 0===e?void 0:e.map((e=>e.type!==r?(0,M.jsx)(s.A,{"aria-label":"fix-data-type",variant:"contained",sx:{my:1},onClick:()=>c(e.type,f,l,u,j,v,b,o),children:(0,M.jsx)(n.A,{variant:"body1",fontWeight:500,children:`Change Data Type to ${D.capitalize(e.type)}`})},e.type):null))})(),(null===f||void 0===f?void 0:f.arrival_format)&&(0,M.jsx)(i.A,{my:1,children:(0,M.jsx)(s.A,{"aria-label":"resolve-data-type",onClick:()=>c(r,f,l,u,j,b,v,o),children:(0,M.jsx)(n.A,{variant:"body1",fontWeight:500,children:"Mark as resolved"})},`${r}-mark-resolved`)})]})]})})]}):(0,M.jsx)(i.A,{px:2,children:(0,M.jsx)(n.A,{variant:"h6",children:r})})}},51544:(e,t,a)=>{a.d(t,{I:()=>r});var i=a(53536),n=a.n(i);const s={createdAt:"Created On",updatedAt:"Updated On",created_by:"Created By",updated_by:"Updated By",webhookUrl:"Webhook URL",recipientAddresses:"Recipient Addresses",expression:"Metric",alert_state:"Alert State",alerts_count:"Alerts Count",notificationChannel:"Notification Channel",alertType:"Alert Type",tableName:"Table name",databaseName:"Database name",batchSize:"Batch size",kafkaBrokers:"Kafka Broker URL",postgresql:"PostgreSQL",mysql:"MySQL","fileFormat.type":"File format","fileFormat.compressed":"Is file compressed?","pollingInterval.type":"Polling Interval","authenticationMechanism.type":"Auth Mechanism","authenticationMechanism.config.access_key":"Access Key","authenticationMechanism.config.secret_key":"Secret Key","authenticationMechanism.config.region":"Region","authenticationMechanism.config.name":"Account name","authenticationMechanism.username":"Username","authenticationMechanism.password":"Password","pollingInterval.schedule":"Schedule",pollingIntervalType:"Polling Interval","connection.host":"Host name","connection.port":"Port number",object:"Cloud store",kafka:"Events (Kafka)",jdbc:"Relational Database",timestampColumn:"Timestamp column",source:"Service Provider",silenceEndTime:"UnMutes in","transformation_function.type":"type","transformation_function.expr":"expression","connector_config.topic":"topic","connector_config.kafkaBrokers":"brokers","connector_config.type":"type","connector_config.connection.host":"host","connector_config.connection.port":"port","connector_config.databaseName":"db","connector_config.tableName":"table",mode:"Mode",arrivalFormat:"Arrival format",dataType:"Data type",isRequired:"Required field",is_batch_event:"Is Batch ?",extraction_key:"Extraction key","dedup_config.drop_duplicates":"Drop duplicates ?",dedup_key:"Dedupe key",drop_duplicates:"Drop duplicates ?",dataset_name:"Master dataset name",denorm_key:"Output field",batch_id:"Batch identifier",validation_mode:"Validation mode",type:"Type",bucket:"Bucket name",prefix:"Prefix",region:"Region",topic:"Kafka topic","dedup_config.dedup_key":"Batch identifier",source_kafka_topic:"Topic",source_kafka_broker_servers:"Kafka Broker URL","kafka-connector-1.0.0":"kafka"},r=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a=n().get(s,e);return t?a:a||e}},74865:(e,t,a)=>{a.d(t,{z:()=>s});var i=a(53536),n=a.n(i);const s=function(e,t){const a=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e:n().omit(e,["properties","required"]),i=JSON.stringify(a,null,2),s=new Blob([i],{type:"application/json"}),r=URL.createObjectURL(s),l=document.createElement("a");l.href=r,l.download=t+".json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r)}}}]);
//# sourceMappingURL=235.d088bfc2.chunk.js.map