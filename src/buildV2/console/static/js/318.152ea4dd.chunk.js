"use strict";(self.webpackChunksunbird_obsrv=self.webpackChunksunbird_obsrv||[]).push([[318],{1195:(e,t,a)=>{a.d(t,{A:()=>v});var s=a(83462),i=a(98533),l=a(42518),d=a(81e3),n=a(4219),o=a(35316),r=a(29347),c=a(73012),u=a(70579);const v=e=>{let{handleClose:t,action:a=null,open:v=!1,context:p={}}=e;return p.show=void 0===p.show||p.show,(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(s.A,{open:v,onClose:t,children:(0,u.jsxs)(d.A,{sx:{p:1,py:1.5},children:[(0,u.jsx)(n.A,{children:null===p||void 0===p?void 0:p.title}),(0,u.jsxs)(o.A,{children:[(0,u.jsx)(i.A,{children:null===p||void 0===p?void 0:p.content}),null===p||void 0===p?void 0:p.component]}),!0===p.show&&(0,u.jsxs)(r.A,{children:[(0,u.jsx)(l.A,{"data-edataid":c.alert_dialog_cancel,color:"error",onClick:e=>t(),children:"Cancel"}),(0,u.jsx)(l.A,{"data-edataid":c.alert_dialog_agree,variant:"contained",onClick:()=>{a&&a(),t(!0)},autoFocus:!0,children:"Agree"})]})]})})})}},99600:(e,t,a)=>{a.d(t,{A:()=>s});const s={home:{home:"home"},login:"login",metrics:{infra:"metrics:infra",overallInfra:"metrics:infra",api:"metrics:api",ingestion:"metrics:ingestion",processing:"metrics:processing",storage:"metrics:storage"},dataset:{list:"dataset:list",create:"dataset:create",edit:"dataset:edit",pages:{schema:"json-schema",input:"input",field:"fields",processing:"processing",advanced:"advanced",review:"review"}},masterdataset:{create:"masterDataset:create",edit:"masterDataset:edit",pages:{schema:"json-schema",input:"input",field:"fields",review:"review"}},systemSettings:{list:"systemSettings:list"}}},13691:(e,t,a)=>{a.d(t,{A:()=>d});var s=a(65043),i=a(73216),l=a(60028);const d=e=>{let{type:t="",subtype:a="PAGINATE",pageid:d,object:n={}}=e;const o=(0,i.zy)(),{pathname:r}=o,c={type:t,subtype:a,pageid:d||r,uri:r};(0,s.useEffect)((()=>{(0,l.rH)({edata:c,object:n})}),[d])}},49318:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Ge,getDraftSourceConfig:()=>Le,getLiveSourceConfig:()=>$e,renderNoDatasetsMessage:()=>qe});var s=a(65043),i=a(67254),l=a(85865),d=a(68903),n=a(26240),o=a(24056),r=a(69392),c=a(81e3),u=a(74600),v=a(53536),p=a(81637),m=a(43845),g=a(79226),x=a(8248),h=a(17392),y=a(76191),j=a(6840),A=a(74605),f=a(4598),b=a(71806),_=a(84882),w=a(28076),D=a(10039),C=a(73460),T=a(71094),S=a(28912),E=a(73216),z=a(70579);const M=function(e){let{columns:t,data:a,title:i="",toggleRefresh:n=""}=e;const[o,r]=(0,s.useState)(a||[]),p=(0,s.useMemo)((()=>S.sB),[]),m=(0,s.useMemo)((()=>({Filter:S.ev})),[]),g=(0,s.useMemo)((()=>({filters:[],hiddenColumns:["tags"]})),[]),[x,h]=(0,s.useState)(!1),y=((0,E.Zp)(),(e,t,a)=>({id:e,color:null,published_date:null,tags:[],onlyTag:!0,name:e,count:t,subRows:a})),j=(0,s.useMemo)((()=>v.reduce(a,((e,t)=>{const a=v.get(t,"tags")||[],s="No Tags";if(0===a.length&&(e[s]?(e[s].count+=1,e[s].subRows.push(t)):e[s]=y(s,1,[t])),a.map((a=>{e[a]?(e[a].count+=1,e[a].subRows.push(t)):e[a]=y(a,1,[t])})),e[s]){const t=e[s];delete e[s],e[s]=t}return e}),{})),[a]),{getTableProps:M,getTableBodyProps:I,headerGroups:k,rows:F,prepareRow:R,state:N,preGlobalFilteredRows:Z,setGlobalFilter:H,toggleRowExpanded:P}=(0,T.useTable)({columns:t,data:o,defaultColumn:m,initialState:g,filterTypes:p,autoResetExpanded:!1},T.useGlobalFilter,T.useFilters,T.useExpanded);return(0,s.useEffect)((()=>{if(x){const e=v.values(j);r(e),v.size(e)>0&&P(0,!1)}else x||r(a)}),[x,n]),(0,z.jsxs)(u.A,{spacing:2,children:[(0,z.jsx)(c.A,{sx:{p:2,pb:0},textAlign:"end",children:(0,z.jsxs)(d.Ay,{container:!0,spacing:2,direction:"row",justifyContent:"space-between",alignItems:"center",sx:{flexWrap:"nowrap"},children:[(0,z.jsx)(d.Ay,{item:!0,display:"flex",alignItems:"center",children:(0,z.jsx)(l.A,{variant:"h5",mr:.5,children:i})}),(0,z.jsxs)(d.Ay,{item:!0,alignItems:"center",display:"flex",children:[(0,z.jsx)(S.y4,{preGlobalFilteredRows:Z,globalFilter:N.globalFilter,setGlobalFilter:H}),(0,z.jsx)(c.A,{mx:2,display:"flex",alignItems:"center",children:(0,z.jsx)(A.A,{control:(0,z.jsx)(f.A,{inputProps:{"aria-label":"toggle-group"},onChange:e=>{h(e.target.checked)},checked:x}),label:"Group by Tags",sx:{mr:0,ml:0}})})]})]})}),(0,z.jsxs)(b.A,{...M(),children:[(0,z.jsx)(_.A,{sx:{borderTopWidth:2},children:k.map((e=>(0,z.jsx)(w.A,{...e.getHeaderGroupProps(),children:e.headers.map((e=>(0,z.jsx)(D.A,{...e.getHeaderProps([{className:e.className}]),children:e.render("Header")})))})))}),(0,z.jsxs)(C.A,{...I(),children:[k.map((e=>(0,z.jsx)(w.A,{...e.getHeaderGroupProps(),children:e.headers.map((e=>(0,z.jsx)(D.A,{...e.getHeaderProps([{className:e.className}]),children:e.canFilter?e.render("Filter"):null})))}))),F.map((e=>(R(e),(0,z.jsx)(w.A,{...e.getRowProps(),children:e.cells.map((e=>(0,z.jsx)(D.A,{...e.getCellProps([{className:e.column.className}]),children:e.render("Cell")})))}))))]})]})]})};var I=a(1195),k=a(57332),F=a(91063),R=a(60446),N=a.n(R),Z=a(28818),H=a(73012),P=a(41020),$=a(12110),L=a(67784),Y=a(51787),q=a(42518),G=a(97508),W=a(8387),U=a(35251),B=a(22505),O=a(79074),K=a(85260);const V=e=>{let{dataset:t,open:a,anchorEl:i,handleClose:d=()=>{},handleSave:n=()=>{}}=e;const o=(0,s.useRef)(),[u,p]=(0,s.useState)(v.get(t,"tags")||[]),g=(0,G.wA)(),x=(0,G.d4)((e=>{var t,a;return(null===e||void 0===e||null===(t=e.config)||void 0===t||null===(a=t.validationLimit)||void 0===a?void 0:a.maxTag)||5})),[h,y]=(0,s.useState)(!0),j=e=>{const t=v.trim(v.toUpper(o.current.value));(e=>{if(void 0!==e&&null!==e&&""!==e)return v.findIndex(u,(t=>t===v.trim(v.toUpper(e))))>-1?(g((0,W.z3)({message:"Tag already exists"})),!1):(0,O.e3)(e)?(g((0,W.z3)({message:"Tag cannot have special characters"})),!1):!(v.size(e)>20)||(g((0,W.z3)({message:"Tag cannot have more than 20 characters"})),!1);return!1})(t)&&(u.length>=x?g((0,W.z3)({message:K.maxTagsLimit.replace("{maxTagsLimit}",x)})):(p((e=>{const a=[...e,t];return o.current.value="",a})),y(!1)))};(0,s.useEffect)((()=>{p(v.get(t,"tags")||[])}),[t]);return(0,z.jsx)(P.Ay,{open:a,anchorEl:i,onClose:d,anchorOrigin:{vertical:"bottom",horizontal:"left"},disablePortal:!1,PaperProps:{sx:{minWidth:"30vw"}},children:(0,z.jsxs)($.A,{elevation:3,sx:{border:"1px solid #dadde9"},children:[(0,z.jsxs)(c.A,{p:2,position:"relative",children:[(0,z.jsx)(L.A,{inputRef:o,fullWidth:!0,label:"Edit tags...",inputProps:{maxlength:20},onChange:e=>{const t=v.get(e,["target","value","length"]);y(t)},onKeyDown:e=>{"Enter"===e.key&&j()},InputProps:{endAdornment:(0,z.jsx)(Y.A,{position:"end",children:(0,z.jsx)(q.A,{"aria-label":"add item",onClick:j,sx:{mr:1,fontSize:"1.25rem"},startIcon:(0,z.jsx)(B.A,{sx:{fontSize:"1.25rem"}}),children:(0,z.jsx)(l.A,{variant:"h6",children:"Add"})})})}}),(0,z.jsx)(c.A,{display:"flex",alignItems:"center",flexWrap:"wrap",flexGrow:1,gap:1,my:1,children:u.map(((e,t)=>(0,z.jsx)(r.A,{title:e,children:(0,z.jsx)(m.A,{size:"small",variant:"outlined",color:"primary",label:(0,z.jsx)(l.A,{variant:"body2",align:"left",children:e}),onDelete:()=>(e=>{p((t=>v.filter(t,(t=>t!==e)))),y(!1)})(e)},t)},t)))})]}),(0,z.jsxs)(c.A,{p:1,m:1,display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,z.jsx)(U.A,{children:(0,z.jsx)(q.A,{variant:"outlined",onClick:d,children:(0,z.jsx)(l.A,{variant:"h5",fontWeight:500,children:"Discard"})})}),(0,z.jsx)(U.A,{children:(0,z.jsx)(q.A,{variant:"contained",onClick:()=>{n(t,u)},disabled:h,children:(0,z.jsx)(l.A,{variant:"h5",fontWeight:500,children:"Save"})})})]})]})})};var X=a(34150),Q=a(39939),J=a(13383),ee=a(21337),te=a(91707),ae=a(92073),se=a(70532),ie=a(59507),le=a(14003),de=a(49777),ne=a(74865),oe=a(688),re=a(32143),ce=a(1259),ue=a(67407),ve=a(65885),pe=a(80599),me=a(98082);const ge=e=>{const{row:t,handleEdit:a,handleDownloadButton:i,handleRetire:l,navigateToPath:d,interactIds:n,DatasetType:o,fileName:u,setExecuteAction:v,DatasetActions:p}=e,[m,g]=(0,s.useState)({}),[x,y]=(0,s.useState)(null),j=()=>{g(!1),y(null)};return(0,z.jsxs)(c.A,{children:[(0,z.jsx)(h.A,{color:"primary",size:"large",id:`demo-positioned-button-${null===t||void 0===t?void 0:t.dataset_id}`,"aria-controls":m[null===t||void 0===t?void 0:t.dataset_id]?"demo-positioned-menu":void 0,"aria-haspopup":"true","aria-expanded":m[null===t||void 0===t?void 0:t.dataset_id]?"true":void 0,onClick:e=>{y(e.currentTarget),g((()=>({[null===t||void 0===t?void 0:t.dataset_id]:!0})))},children:(0,z.jsx)(me.A,{})}),(0,z.jsx)(oe.A,{id:`demo-positioned-button-${null===t||void 0===t?void 0:t.dataset_id}`,"aria-labelledby":"demo-positioned-button",anchorEl:x,open:m[null===t||void 0===t?void 0:t.dataset_id],onClose:j,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},children:(0,z.jsxs)(c.A,{sx:{display:"flex"},children:[(0,z.jsx)(re.A,{onClick:j,children:(0,z.jsx)(r.A,{title:"Create Events",onClick:e=>d(`/datasets/addEvents/${null===t||void 0===t?void 0:t.dataset_id}`),children:(0,z.jsx)(h.A,{"data-edataid":n.push_dataset_events,"data-objectid":null===t||void 0===t?void 0:t.dataset_id,"data-objecttype":"dataset",color:"primary",size:"large",children:(0,z.jsx)(ce.A,{})})})}),(0,z.jsx)(re.A,{onClick:j,children:(0,z.jsx)(r.A,{title:"Edit Dataset",children:(0,z.jsx)(h.A,{"data-edataid":n.edit_dataset,"data-objectid":null===t||void 0===t?void 0:t.id,"data-objecttype":(null===t||void 0===t?void 0:t.type)===o.MasterDataset?"masterDataset":"dataset",color:"primary",size:"large",onClick:()=>{v(p.Edit),a(t)},children:(0,z.jsx)(ue.A,{})})})}),(0,z.jsx)(re.A,{onClick:j,children:(0,z.jsx)(r.A,{title:"Export Dataset",children:(0,z.jsx)(h.A,{color:"primary",size:"large",onClick:e=>i(null===t||void 0===t?void 0:t.dataset_id,null===t||void 0===t?void 0:t.version,null===t||void 0===t?void 0:t.status,u),"data-objectid":null===t||void 0===t?void 0:t.dataset_id,"data-objecttype":(null===t||void 0===t?void 0:t.type)===o.MasterDataset?"masterDataset":"dataset",children:(0,z.jsx)(ve.A,{})})})}),(0,z.jsx)(re.A,{onClick:j,children:(0,z.jsx)(r.A,{title:"Retire Dataset",children:(0,z.jsx)(h.A,{color:"error",size:"large",onClick:e=>{v(p.Retire),l(t)},"data-objectid":null===t||void 0===t?void 0:t.dataset_id,"data-objecttype":(null===t||void 0===t?void 0:t.type)===o.MasterDataset?"masterDataset":"dataset",children:(0,z.jsx)(pe.A,{})})})})]})})]})};var xe=a(45691),he=a(48348),ye=a(91462);const je="YYYY-MM-DDT00:00:00+05:30",Ae={[v.toLower(ie.Zs.Live)]:"success",[v.toLower(ie.Zs.Retired)]:"secondary",[v.toLower(ie.Zs.Purged)]:"secondary"},fe=e=>{let{setDatasetType:t,sourceConfigs:a}=e;const[i,d]=(0,s.useState)(!1),[n,o]=(0,s.useState)([]),[A,f]=(0,s.useState)({}),[b,_]=(0,s.useState)(null),[w,D]=(0,s.useState)("false"),[C,T]=(0,s.useState)(!1),S=Boolean(b),[R,P]=(0,s.useState)(null),$=(0,E.Zp)(),L=e=>{$(e)},[Y,q]=(0,s.useState)(""),G=async()=>{T(!0);try{const e=await(0,X.MM)({data:{filters:{status:[ie.Zs.Live]}}}),t=v.get(e,"data");v.map(t,(async e=>$e(e,a))),o(t),(0,Q.dispatch)((0,he.Q)(t))}catch(e){(0,Q.dispatch)((0,W.z3)({message:K["datasets-fetch-failure"]}))}finally{T(!1)}};(0,s.useEffect)((()=>{G()}),[]);const U=e=>{const[t,a]=(0,s.useState)(null),[i,l]=(0,s.useState)(!1),d=(0,s.useMemo)((()=>t),[t]);if((0,s.useEffect)((()=>{d||(async e=>{l(!0);try{let t=await(0,k.p)(e);const s=Array.isArray(t)?v.first(t):t;a(s)}catch(t){}finally{l(!1)}})(e)}),[]),i)return(0,z.jsx)(p.A,{size:20,color:"success"});if([null,void 0].includes(t))return"N/A";const n=v.get(t,"hoverValue")||"",o=v.get(t,"value")||t;return(0,z.jsx)("div",{children:(0,z.jsx)(r.A,{title:n,children:o})})},B=()=>{f({}),ve()},O=async(e,t,a,s)=>{try{const t=await(0,X.r$)(e,ie.Zs.Live),a=v.get(t,"data.result");if(a){const e=v.get((0,de.Mt)({schema:a},{schema:(0,de.E4)(null===a||void 0===a?void 0:a.data_schema)}),"schema");(0,ne.z)(e,s)}}catch(i){(0,Q.dispatch)((0,W.z3)({message:"Unable to export dataset"}))}},oe=(0,s.useMemo)((()=>[{Header:()=>null,id:"expander",className:"cell-center",tipText:"",editable:"false",Cell:e=>{let{row:t}=e;const a=t.isExpanded?(0,z.jsx)(ee.A,{}):(0,z.jsx)(te.A,{});return t.canExpand&&0===t.depth&&(0,z.jsx)(c.A,{sx:{fontSize:"1rem"},...t.getToggleRowExpandedProps(),children:a})},SubCell:()=>null},{Header:"Name",accessor:"id",disableFilters:!0,disableGroupBy:!0,Aggregated:()=>null,Cell:e=>{var t,a,s;const i=(null===e||void 0===e||null===(t=e.cell)||void 0===t||null===(a=t.row)||void 0===a?void 0:a.original)||{};return(0,z.jsxs)(c.A,{minWidth:"13.5rem",children:[(null===i||void 0===i?void 0:i.status)&&(null===i||void 0===i?void 0:i.type)&&(0,z.jsxs)(c.A,{display:"flex",alignItems:"center",mb:1,children:[(0,z.jsx)(r.A,{title:null===i||void 0===i?void 0:i.status,children:(0,z.jsx)(J.A,{sx:{fontSize:"1.25rem"},color:v.get(Ae,v.toLower(null===i||void 0===i?void 0:i.status))||"secondary"})}),(0,z.jsx)(r.A,{title:null===i||void 0===i?void 0:i.id,children:(0,z.jsx)(l.A,{align:"left",variant:"subtitle1",children:null===i||void 0===i?void 0:i.name})})]}),(null===i||void 0===i?void 0:i.onlyTag)&&(0,z.jsxs)(c.A,{display:"flex",alignItems:"center",children:[(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:null===i||void 0===i?void 0:i.name}),color:"secondary",variant:"combined",size:"small"}),(0,z.jsx)(l.A,{align:"left",variant:"subtitle1",ml:1,children:`(${null===i||void 0===i?void 0:i.count})`})]}),(0,z.jsxs)(c.A,{display:"flex",flexDirection:"row",gap:1,flexWrap:"wrap",flexGrow:1,alignItems:"center",children:[(null===i||void 0===i?void 0:i.sources)&&(null===i||void 0===i?void 0:i.sources.map(((e,t)=>(0,z.jsx)(r.A,{title:"Source Connector",children:(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:e}),color:"primary",variant:"combined",size:"small"},t)})))),(null===i||void 0===i?void 0:i.type)&&(0,z.jsx)(r.A,{title:"Dataset Type",children:(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:v.toUpper(null===i||void 0===i?void 0:i.type)}),color:"dataset"==(null===i||void 0===i?void 0:i.type)?"success":"info",variant:"combined",size:"small"})}),(null===i||void 0===i?void 0:i.tags)&&(null===i||void 0===i||null===(s=i.tags)||void 0===s?void 0:s.map(((e,t)=>(0,z.jsx)(r.A,{title:"Custom Tags",children:(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:e}),color:"secondary",variant:"combined",size:"small"},t)}))))]})]})}},{Header:()=>null,accessor:"tags",disableFilters:!0},{Header:"Total Events (Today)",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{},l=v.get(i,"type")===ie.DE.MasterDataset,d=null===i||void 0===i?void 0:i.dataset_id,n=N()().format(je),o=N()().add(1,"day").format(je),r=F.v.total_events_processed({datasetId:d,intervals:`${n}/${o}`,master:l}),c=v.get(Z.A,"total_events_processed.query");return null!==i&&void 0!==i&&i.onlyTag?null:U({...c,body:r})}},{Header:"Total Events (Yesterday)",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{},l=v.get(i,"type")===ie.DE.MasterDataset,d=null===i||void 0===i?void 0:i.dataset_id,n=N()().subtract(1,"day").format(je),o=N()().format(je),r=F.v.total_events_processed({datasetId:d,intervals:`${n}/${o}`,master:l}),c=v.get(Z.A,"total_events_processed.query");return null!==i&&void 0!==i&&i.onlyTag?null:U({...c,body:r})}},{Header:"Avg Processing Time (Today)",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{},l=v.get(i,"type")===ie.DE.MasterDataset,d=null===i||void 0===i?void 0:i.dataset_id,n=N()().format(je),o=N()().add(1,"day").format(je),r=F.v.druid_avg_processing_time({datasetId:d,intervals:`${n}/${o}`,master:l}),c=v.get(Z.A,"druid_avg_processing_time.query");return null!==i&&void 0!==i&&i.onlyTag?null:U({...c,body:r})}},{Header:"Avg Processing Time (Yesterday)",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{},l=v.get(i,"type")===ie.DE.MasterDataset,d=null===i||void 0===i?void 0:i.dataset_id,n=N()().subtract(1,"day").format(je),o=N()().format(je),r=F.v.druid_avg_processing_time({datasetId:d,intervals:`${n}/${o}`,master:l}),c=v.get(Z.A,"druid_avg_processing_time.query");return null!==i&&void 0!==i&&i.onlyTag?null:U({...c,body:r})}},{Header:"Last Synced Time",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{},l=v.get(i,"type")===ie.DE.MasterDataset,d=null===i||void 0===i?void 0:i.dataset_id,n=N()().subtract(10,"day").format(je),o=N()().add(1,"day").format(je),r=F.v.last_synced_time({datasetId:d,intervals:`${n}/${o}`,master:l}),c=v.get(Z.A,"last_synced_relative_time.query");return null!==i&&void 0!==i&&i.onlyTag?null:U({...c,body:r})}},{Header:"Event Failed (Today)",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{},l=v.get(i,"type")===ie.DE.MasterDataset,d=v.get(i,"dataset_id"),n=N()().endOf("day").unix(),o=l?v.get(Z.A,"failed_events_summary_master_datasets.query"):v.get(Z.A,"failed_events_summary.query");return null!==i&&void 0!==i&&i.onlyTag?null:U({...o,time:n,dataset:d,master:l})}},{Header:"Actions",accessor:"color",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{};if(null!==i&&void 0!==i&&i.onlyTag)return null;const l=(null===i||void 0===i?void 0:i.type)==ie.DE.MasterDataset,d=`${null===i||void 0===i?void 0:i.name}_${null===i||void 0===i?void 0:i.status}_${null===i||void 0===i?void 0:i.version}`;return(0,z.jsxs)(u.A,{direction:"row",justifyContent:"flex-start",alignItems:"center",children:[(0,z.jsx)(r.A,{title:"View Dataset",onClick:e=>L(`/datasets/management/${null===i||void 0===i?void 0:i.dataset_id}?master=${l}&status=${ie.Zs.Live}`),children:(0,z.jsx)(h.A,{"data-objectid":null===i||void 0===i?void 0:i.dataset_id,"data-objecttype":"dataset",color:"primary",size:"large",children:(0,z.jsx)(y.A,{})})}),(0,z.jsx)(r.A,{title:"View Metrics",onClick:e=>L(`/datasets/${null===i||void 0===i?void 0:i.dataset_id}`),children:(0,z.jsx)(h.A,{"data-edataid":H.view_dataset_metrics,"data-objectid":null===i||void 0===i?void 0:i.dataset_id,"data-objecttype":"dataset",color:"primary",size:"large",children:(0,z.jsx)(j.A,{})})}),(0,z.jsx)(r.A,{title:"Edit Tags",children:(0,z.jsx)(h.A,{"data-edataid":H.edit_dataset_tags,"data-objectid":null===i||void 0===i?void 0:i.dataset_id,"data-objecttype":"dataset_tags",color:"primary",size:"large",onClick:e=>pe(e,i),disabled:!0,children:(0,z.jsx)(xe.A,{})})}),(0,z.jsx)(r.A,{title:"View More Actions",children:(0,z.jsx)(ge,{row:i,handleEdit:ue,handleDownloadButton:O,handleRetire:ce,navigateToPath:L,interactIds:H,DatasetType:ie.DE,fileName:d,setExecuteAction:q,DatasetActions:ie.Gd})})]})}}]),[]),re=async()=>{if(R){T(!0);try{await(0,X.aQ)({id:v.get(R,"dataset_id")}),t(ie.Zs.Retired),L(`?status=${ie.Zs.Retired}`),(0,Q.dispatch)((0,W.kX)({message:K["dataset-retire-success"]}))}catch(e){const t=v.get(e,"response.data.params.errmsg")||K["dataset-retire-failure"];(0,Q.dispatch)((0,W.z3)({message:t}))}finally{G(),T(!1),P(null)}}},ce=e=>{P(e),d(!0)},ue=e=>{P(e),d(!0)},ve=()=>{_(null)},pe=(e,t)=>{_(e.currentTarget),f(t)},me=async()=>{d(!0);await(0,X.sX)({selection:v.get(R,"dataset_id")||"",navigateToPath:L,dispatch:Q.dispatch,error:W.z3})};return(0,z.jsxs)(g.A,{content:!1,children:[(0,z.jsx)(ye.A,{open:C}),C?(0,se.Y)({config:{type:"table",width:"100%"}}):(0,z.jsx)(z.Fragment,{children:v.isEmpty(n)?qe(K["datasets-not-found"]):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(x.A,{children:(0,z.jsx)(M,{columns:oe,data:v.orderBy(n,["published_date"],["desc"]),title:"Live Datasets",toggleRefresh:w})}),(0,z.jsx)(I.A,{open:i,handleClose:e=>{d(!1)},context:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch(Y){case ie.Gd.Retire:return{title:(0,z.jsx)(le.A,{id:"retire-dataset-title"}),content:(0,z.jsx)(le.A,{id:"retire-dataset-context",values:{id:e}})};case ie.Gd.Edit:return{title:(0,z.jsx)(le.A,{id:"edit-dataset-title"}),content:(0,z.jsx)(le.A,{id:"edit-dataset-context",values:{id:e}})};case ie.Gd.AddRollup:return{title:(0,z.jsx)(le.A,{id:"add-rollup-title"}),content:(0,z.jsx)(le.A,{id:"add-rollup-context",values:{id:e}})}}}(v.get(R,"name")),action:()=>{switch(Y){case ie.Gd.Retire:re();break;case ie.Gd.Edit:me();break;case ie.Gd.AddRollup:(async()=>{await(0,X.sX)({selection:v.get(R,"dataset_id")||"",navigateToPath:L,dispatch:Q.dispatch,rollupRedirect:!0,error:W.z3})})()}}}),(0,z.jsx)(V,{dataset:A,handleClose:B,handleSave:async(e,t)=>{const{dataset_id:a,name:s,status:i,id:l}=e,d={dataset_id:a,name:s,status:i,tags:t};try{T(!0),await(0,X.Iy)({data:{...d}}),(e=>{let{dataset_id:t,status:a,id:s,name:i,tags:l}=e;o((e=>{let d=v.cloneDeep(e);const n=v.findIndex(d,(e=>t===v.get(e,"dataset_id")&&a===v.get(e,"status")&&s===v.get(e,"id")&&i===v.get(e,"name")));return v.set(d[n],"tags",l),d})),B()})({dataset_id:a,status:i,id:l,name:s,tags:t}),D((0,ae.A)())}catch(n){(0,Q.dispatch)((0,W.z3)({message:"Failed to update tags"}))}finally{ve(),T(!1)}},open:S,anchorEl:b})]})})]})};var be=a(78240),_e=a(98612);const we=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{title:(0,z.jsx)(le.A,{id:"delete-dataset-title"}),content:(0,z.jsx)(le.A,{id:"delete-dataset-context",values:{id:e}})}},De=e=>{const{sourceConfigs:t}=e,[a,i]=(0,s.useState)([]),[d,n]=(0,s.useState)(!1),o=((0,E.Zp)(),(0,G.wA)()),[p,y]=(0,s.useState)(!1),[j,A]=(0,s.useState)({}),[f,b]=(0,s.useState)(null),[_,w]=(0,s.useState)("false"),[D,C]=(0,s.useState)(null),T=Boolean(f),S=((0,G.d4)((e=>null===e||void 0===e?void 0:e.wizard)),async()=>{y(!0);try{const e=await(0,X.MM)({data:{filters:{status:[ie.Zs.Draft]}}}),a=v.get(e,"data");(0,X.iw)({datasets:a}),v.map(a,(async e=>Le(e,t))),i(a),o((0,he.Q)(a))}catch(e){o((0,W.z3)({message:K["datasets-fetch-failure"]}))}finally{y(!1)}});(0,s.useEffect)((()=>{S()}),[]);const k=()=>{A({}),R()},F=(0,s.useMemo)((()=>[{Header:()=>null,id:"expander",className:"cell-center",tipText:"",editable:"false",Cell:e=>{let{row:t}=e;const a=t.isExpanded?(0,z.jsx)(ee.A,{}):(0,z.jsx)(te.A,{});return t.canExpand&&0===t.depth&&(0,z.jsx)(c.A,{sx:{fontSize:"1rem"},...t.getToggleRowExpandedProps(),children:a})},SubCell:()=>null},{Header:"Name",accessor:"id",disableFilters:!0,Cell:e=>{var t,a,s;const i=(null===e||void 0===e||null===(t=e.cell)||void 0===t||null===(a=t.row)||void 0===a?void 0:a.original)||{};return(0,z.jsxs)(c.A,{minWidth:"10rem",children:[(null===i||void 0===i?void 0:i.onlyTag)&&(0,z.jsxs)(c.A,{display:"flex",alignItems:"center",children:[(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:null===i||void 0===i?void 0:i.name}),color:"secondary",variant:"combined",size:"small"}),(0,z.jsx)(l.A,{align:"left",variant:"subtitle1",ml:1,children:`(${null===i||void 0===i?void 0:i.count})`})]}),(null===i||void 0===i?void 0:i.status)&&(null===i||void 0===i?void 0:i.type)&&(0,z.jsxs)(c.A,{display:"flex",alignItems:"center",mb:1,children:[(0,z.jsx)(r.A,{title:null===i||void 0===i?void 0:i.status,children:(0,z.jsx)(J.A,{sx:{fontSize:"1.25rem"},color:"warning"})}),(0,z.jsx)(r.A,{title:null===i||void 0===i?void 0:i.dataset_id,children:(0,z.jsx)(l.A,{align:"left",variant:"subtitle1",children:null===i||void 0===i?void 0:i.name})})]}),(0,z.jsxs)(c.A,{display:"flex",flexDirection:"row",gap:1,flexWrap:"wrap",flexGrow:1,alignItems:"center",children:[(null===i||void 0===i?void 0:i.sources)&&(null===i||void 0===i?void 0:i.sources.map(((e,t)=>(0,z.jsx)(r.A,{title:"Source Connector",children:(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:e}),color:"primary",variant:"combined",size:"small"},t)})))),(null===i||void 0===i?void 0:i.type)&&(0,z.jsx)(r.A,{title:"Dataset Type",children:(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:v.toUpper(null===i||void 0===i?void 0:i.type)}),color:"dataset"==(null===i||void 0===i?void 0:i.type)?"success":"info",variant:"combined",size:"small"})}),(null===i||void 0===i?void 0:i.tags)&&(null===i||void 0===i||null===(s=i.tags)||void 0===s?void 0:s.map(((e,t)=>(0,z.jsx)(r.A,{title:"Custom Tag",children:(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:e}),color:"secondary",variant:"combined",size:"small"},t)}))))]})]})}},{Header:"Created",accessor:"created_date",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{};if(null!==i&&void 0!==i&&i.onlyTag)return null;if(!a)return["N/A","primary"];const l=N()(a).fromNow();return(0,z.jsx)(r.A,{title:N()(a).format("YYYY-MM-DD HH:mm:ss")||"-",placement:"bottom-start",children:(0,z.jsx)(c.A,{minWidth:"10rem",children:l})})}},{Header:"Updated",accessor:"updated_date",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{};if(null!==i&&void 0!==i&&i.onlyTag)return null;if(!a)return["N/A","primary"];const l=N()(a).fromNow();return(0,z.jsx)(r.A,{title:N()(a).format("YYYY-MM-DD HH:mm:ss")||"-",placement:"bottom-start",children:(0,z.jsx)(c.A,{minWidth:"10rem",children:l})})}},{Header:"Actions",accessor:"color",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{};return null!==i&&void 0!==i&&i.onlyTag?null:(0,z.jsxs)(u.A,{direction:"row",justifyContent:"flex-start",alignItems:"center",children:[(0,z.jsx)(r.A,{title:"Edit Tags",children:(0,z.jsx)(h.A,{"data-edataid":H.edit_dataset_tags,"data-objectid":null===i||void 0===i?void 0:i.dataset_id,"data-objecttype":"dataset_tags",color:"primary",size:"large",onClick:e=>Z(e,i),children:(0,z.jsx)(xe.A,{})})}),(0,z.jsx)(r.A,{title:"Edit Dataset",children:(0,z.jsx)(h.A,{"data-edataid":H.edit_dataset,"data-objectid":null===i||void 0===i?void 0:i.dataset_id,"data-objecttype":(null===i||void 0===i?void 0:i.type)===ie.DE.MasterDataset?ie.DE.MasterDataset:ie.DE.Dataset,color:"primary",size:"large",onClick:()=>{const e=null===i||void 0===i?void 0:i.dataset_id,t=(null===i||void 0===i||i.type,ie.DE.MasterDataset,null===i||void 0===i||i.status,`/home/ingestion/schema-details/${e}`);window.location.href=t},children:(0,z.jsx)(ue.A,{})})}),(0,z.jsx)(r.A,{title:"Delete Dataset",children:(0,z.jsx)(h.A,{color:"error",size:"large",onClick:e=>(C(i),void n(!0)),"data-objectid":null===i||void 0===i?void 0:i.dataset_id,"data-objecttype":(null===i||void 0===i?void 0:i.type)===ie.DE.MasterDataset?ie.DE.MasterDataset:ie.DE.Dataset,children:(0,z.jsx)(be.A,{})})})]})}}]),[]),R=()=>{b(null)},Z=(e,t)=>{b(e.currentTarget),A(t)};return(0,z.jsxs)(g.A,{content:!1,children:[p&&(0,z.jsx)(_e.A,{}),(0,z.jsx)(ye.A,{open:p}),p?(0,se.Y)({config:{type:"table",width:"100%"}}):(0,z.jsx)(z.Fragment,{children:v.isEmpty(a)?qe(K["datasets-not-found"]):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(x.A,{children:(0,z.jsx)(M,{columns:F,data:v.orderBy(a,["created_date"],["desc"]),title:"Draft Datasets",toggleRefresh:_})}),(0,z.jsx)(I.A,{open:d,handleClose:e=>{n(!1)},context:we(v.get(D,"name")),action:async()=>{if(D){y(!0);try{await(0,X.gu)({id:v.get(D,"dataset_id")}),o((0,W.kX)({message:K["dataset-delete-success"]}))}catch(e){const t=v.get(e,"response.data.params.errmsg")||K["dataset-delete-failure"];o((0,W.z3)({message:t}))}finally{await S(),w((0,ae.A)()),y(!1),C(null)}}}}),(0,z.jsx)(V,{dataset:j,handleClose:k,handleSave:async(e,t)=>{const{dataset_id:a,name:s,status:l,id:d,tags:n}=e,r=(0,X.lX)({tags:n,tagsData:t}),c={dataset_id:a,name:s,...v.size(r)&&{tags:r}};try{y(!0);await(0,X.yE)({data:{...c}});(e=>{let{dataset_id:t,status:a,id:s,name:l,tags:d}=e;i((e=>{let i=v.cloneDeep(e);const n=v.findIndex(i,(e=>t===v.get(e,"dataset_id")&&a===v.get(e,"status")&&s===v.get(e,"id")&&l===v.get(e,"name")));return v.set(i[n],"tags",d),i})),k()})({dataset_id:a,status:l,id:d,name:s,tags:t}),w((0,ae.A)())}catch(u){o((0,W.z3)({message:K["dataset-update-tags-failure"]}))}finally{R(),y(!1)}},open:T,anchorEl:f})]})})]})};var Ce=a(13691),Te=a(99600);const Se=e=>{const{sourceConfigs:t}=e,a=(0,G.wA)(),[i,d]=(0,s.useState)([]),[n,o]=(0,s.useState)(!1),[u,p]=(0,s.useState)("false");(0,s.useEffect)((()=>{(async()=>{o(!0);try{const e=await(0,X.MM)({data:{filters:{status:[ie.Zs.Retired]}}}),s=v.get(e,"data");v.map(s,(async e=>Le(e,t))),d(s),a((0,he.Q)(s))}catch(e){a((0,W.z3)({message:K["datasets-fetch-failure"]}))}finally{o(!1)}})()}),[]);const h=(0,s.useMemo)((()=>[{Header:()=>null,id:"expander",className:"cell-center",tipText:"",editable:"false",Cell:e=>{let{row:t}=e;const a=t.isExpanded?(0,z.jsx)(ee.A,{}):(0,z.jsx)(te.A,{});return t.canExpand&&0===t.depth&&(0,z.jsx)(c.A,{sx:{fontSize:"1rem"},...t.getToggleRowExpandedProps(),children:a})},SubCell:()=>null},{Header:"Name",accessor:"id",disableFilters:!0,Cell:e=>{var t,a,s;const i=(null===e||void 0===e||null===(t=e.cell)||void 0===t||null===(a=t.row)||void 0===a?void 0:a.original)||{};return(0,z.jsxs)(c.A,{minWidth:"10rem",children:[(null===i||void 0===i?void 0:i.onlyTag)&&(0,z.jsxs)(c.A,{display:"flex",alignItems:"center",children:[(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:null===i||void 0===i?void 0:i.name}),color:"secondary",variant:"combined",size:"small"}),(0,z.jsx)(l.A,{align:"left",variant:"subtitle1",ml:1,children:`(${null===i||void 0===i?void 0:i.count})`})]}),(null===i||void 0===i?void 0:i.status)&&(null===i||void 0===i?void 0:i.type)&&(0,z.jsxs)(c.A,{display:"flex",alignItems:"center",mb:1,children:[(0,z.jsx)(r.A,{title:null===i||void 0===i?void 0:i.status,children:(0,z.jsx)(J.A,{sx:{fontSize:"1.25rem"},color:"secondary"})}),(0,z.jsx)(r.A,{title:null===i||void 0===i?void 0:i.dataset_id,children:(0,z.jsx)(l.A,{align:"left",variant:"subtitle1",children:null===i||void 0===i?void 0:i.name})})]}),(0,z.jsxs)(c.A,{display:"flex",flexDirection:"row",gap:1,flexWrap:"wrap",flexGrow:1,alignItems:"center",children:[(null===i||void 0===i?void 0:i.sources)&&(null===i||void 0===i?void 0:i.sources.map(((e,t)=>(0,z.jsx)(r.A,{title:"Source Connector",children:(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:e}),color:"primary",variant:"combined",size:"small"},t)})))),(null===i||void 0===i?void 0:i.type)&&(0,z.jsx)(r.A,{title:"Dataset Type",children:(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:v.toUpper(null===i||void 0===i?void 0:i.type)}),color:"dataset"==(null===i||void 0===i?void 0:i.type)?"success":"info",variant:"combined",size:"small"})}),(null===i||void 0===i?void 0:i.tags)&&(null===i||void 0===i||null===(s=i.tags)||void 0===s?void 0:s.map(((e,t)=>(0,z.jsx)(r.A,{title:"Custom Tag",children:(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:e}),color:"secondary",variant:"combined",size:"small"},t)}))))]})]})}},{Header:"Created",accessor:"created_date",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{};if(null!==i&&void 0!==i&&i.onlyTag)return null;if(!a)return["N/A","primary"];const l=N()(a).fromNow();return(0,z.jsx)(r.A,{title:N()(a).format("YYYY-MM-DD HH:mm:ss")||"-",placement:"bottom-start",children:(0,z.jsx)(c.A,{minWidth:"10rem",children:l})})}},{Header:"Retired",accessor:"updated_date",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{};if(null!==i&&void 0!==i&&i.onlyTag)return null;const l=N()(a).fromNow();return(0,z.jsx)(r.A,{title:N()(a).format("YYYY-MM-DD HH:mm:ss")||"-",placement:"bottom-start",children:(0,z.jsx)(c.A,{minWidth:"10rem",children:l})})}}]),[]);return(0,z.jsxs)(g.A,{content:!1,children:[n&&(0,z.jsx)(_e.A,{}),(0,z.jsx)(ye.A,{open:n}),n?(0,se.Y)({config:{type:"table",width:"100%"}}):(0,z.jsx)(z.Fragment,{children:v.isEmpty(i)?qe(K["datasets-not-found"]):(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(x.A,{children:(0,z.jsx)(M,{columns:h,data:v.orderBy(i,["created_date"],["desc"]),title:"Retired Datasets",toggleRefresh:u})})})})]})};var Ee=a(98257),ze=a(75337),Me=a(86506),Ie=a(22016),ke=a(15710),Fe=a(77677),Re=a(47830),Ne=a(18666),Ze=a(78293);const He=e=>{let{setDatasetType:t,sourceConfigs:a}=e;const[i,d]=(0,s.useState)([]),[n,o]=(0,s.useState)(!1),p=(0,E.Zp)(),y=(0,G.wA)(),[j,A]=(0,s.useState)(!1),[f,b]=(0,s.useState)({}),[_,w]=(0,s.useState)(null),[D,C]=(0,s.useState)("false"),[T,S]=(0,s.useState)(null),k=Boolean(_),F=(0,G.d4)((e=>null===e||void 0===e?void 0:e.wizard)),R=(v.get(F,"pages.datasetConfiguration.state.config.versionKey"),async()=>{A(!0);try{const e=await(0,X.MM)({data:{filters:{status:[ie.Zs.ReadyToPublish]}}}),t=v.get(e,"data");(0,X.iw)({datasets:t}),v.map(t,(async e=>Le(e,a))),d(t),y((0,he.Q)(t))}catch(e){y((0,W.z3)({message:K["datasets-fetch-failure"]}))}finally{A(!1)}});(0,s.useEffect)((()=>{R()}),[]);const Z=async e=>{var a;await(0,Re.C)({data:{datasetId:e}}),y((0,W.kX)({message:K["dataset-publish-success"]})),R(),t(ie.Zs.Live),a=`?status=${ie.Zs.Live}`,p(a)},P=()=>{b({}),L()},$=(0,s.useMemo)((()=>[{Header:()=>null,id:"expander",className:"cell-center",tipText:"",editable:"false",Cell:e=>{let{row:t}=e;const a=t.isExpanded?(0,z.jsx)(ee.A,{}):(0,z.jsx)(te.A,{});return t.canExpand&&0===t.depth&&(0,z.jsx)(c.A,{sx:{fontSize:"1rem"},...t.getToggleRowExpandedProps(),children:a})},SubCell:()=>null},{Header:"Name",accessor:"id",disableFilters:!0,Cell:e=>{var t,a,s;const i=(null===e||void 0===e||null===(t=e.cell)||void 0===t||null===(a=t.row)||void 0===a?void 0:a.original)||{};return(0,z.jsxs)(c.A,{minWidth:"10rem",children:[(null===i||void 0===i?void 0:i.onlyTag)&&(0,z.jsxs)(c.A,{display:"flex",alignItems:"center",children:[(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:null===i||void 0===i?void 0:i.name}),color:"secondary",variant:"combined",size:"small"}),(0,z.jsx)(l.A,{align:"left",variant:"subtitle1",ml:1,children:`(${null===i||void 0===i?void 0:i.count})`})]}),(null===i||void 0===i?void 0:i.status)&&(null===i||void 0===i?void 0:i.type)&&(0,z.jsxs)(c.A,{display:"flex",alignItems:"center",mb:1,children:[(0,z.jsx)(r.A,{title:null===i||void 0===i?void 0:i.status,children:(0,z.jsx)(J.A,{sx:{fontSize:"1.25rem"},color:"info"})}),(0,z.jsx)(r.A,{title:null===i||void 0===i?void 0:i.dataset_id,children:(0,z.jsx)(l.A,{align:"left",variant:"subtitle1",children:null===i||void 0===i?void 0:i.name})})]}),(0,z.jsxs)(c.A,{display:"flex",flexDirection:"row",gap:1,flexWrap:"wrap",flexGrow:1,alignItems:"center",children:[(null===i||void 0===i?void 0:i.sources)&&(null===i||void 0===i?void 0:i.sources.map(((e,t)=>(0,z.jsx)(r.A,{title:"Source Connector",children:(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:e}),color:"primary",variant:"combined",size:"small"},t)})))),(null===i||void 0===i?void 0:i.type)&&(0,z.jsx)(r.A,{title:"Dataset Type",children:(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:v.toUpper(null===i||void 0===i?void 0:i.type)}),color:"dataset"==(null===i||void 0===i?void 0:i.type)?"success":"info",variant:"combined",size:"small"})}),(null===i||void 0===i?void 0:i.tags)&&(null===i||void 0===i||null===(s=i.tags)||void 0===s?void 0:s.map(((e,t)=>(0,z.jsx)(r.A,{title:"Custom Tag",children:(0,z.jsx)(m.A,{label:(0,z.jsx)(l.A,{align:"left",variant:"caption",children:e}),color:"secondary",variant:"combined",size:"small"},t)}))))]})]})}},{Header:"Created",accessor:"created_date",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{};if(null!==i&&void 0!==i&&i.onlyTag)return null;if(!a)return["N/A","primary"];const l=N()(a).fromNow();return(0,z.jsx)(r.A,{title:N()(a).format("YYYY-MM-DD HH:mm:ss")||"-",placement:"bottom-start",children:(0,z.jsx)(c.A,{minWidth:"10rem",children:l})})}},{Header:"Updated",accessor:"updated_date",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{};if(null!==i&&void 0!==i&&i.onlyTag)return null;if(!a)return["N/A","primary"];const l=N()(a).fromNow();return(0,z.jsx)(r.A,{title:N()(a).format("YYYY-MM-DD HH:mm:ss")||"-",placement:"bottom-start",children:(0,z.jsx)(c.A,{minWidth:"10rem",children:l})})}},{Header:"Actions",accessor:"color",disableFilters:!0,Cell:e=>{var t;let{value:a,cell:s}=e;const i=(null===s||void 0===s||null===(t=s.row)||void 0===t?void 0:t.original)||{},l=`${null===i||void 0===i?void 0:i.name}_${null===i||void 0===i?void 0:i.status}_${null===i||void 0===i?void 0:i.version}`;if(null!==i&&void 0!==i&&i.onlyTag)return null;const d=v.toLower(null===i||void 0===i?void 0:i.status),n=v.toLower(d)!==v.toLower(ie.Zs.ReadyToPublish)||j;return(0,z.jsxs)(u.A,{direction:"row",justifyContent:"flex-start",alignItems:"center",children:[(0,z.jsx)(r.A,{title:"Publish Dataset",onClick:e=>(async e=>{A(!0);const{dataset_id:t}=e;try{await Z(t)}catch(a){if("DATASET_API_VERSION_MISMATCH"===v.get(a,"response.data.error.code"))try{await Ne.LV.get(`${Ze.A.readDataset}/${t}?mode=edit`),await Z(t)}catch(a){y((0,W.z3)({message:K["dataset-publish-failure"]}))}else y((0,W.z3)({message:K["dataset-publish-failure"]}))}finally{A(!1)}})(i),children:(0,z.jsx)(h.A,{"data-edataid":H.publish_dataset,"data-objectid":null===i||void 0===i?void 0:i.dataset_id,"data-objecttype":(null===i||void 0===i?void 0:i.type)===ie.DE.MasterDataset?"masterDataset":"dataset",color:"primary",size:"large",disabled:n,children:(0,z.jsx)(Fe.A,{})})}),(0,z.jsx)(r.A,{title:"Edit Tags",children:(0,z.jsx)(h.A,{"data-edataid":H.edit_dataset_tags,"data-objectid":null===i||void 0===i?void 0:i.dataset_id,"data-objecttype":"dataset_tags",color:"primary",size:"large",onClick:e=>Y(e,i),children:(0,z.jsx)(xe.A,{})})}),(0,z.jsx)(r.A,{title:"Edit Dataset",children:(0,z.jsx)(h.A,{"data-edataid":H.edit_dataset,"data-objectid":null===i||void 0===i?void 0:i.dataset_id,"data-objecttype":(null===i||void 0===i?void 0:i.type)===ie.DE.MasterDataset?"masterDataset":"dataset",color:"primary",size:"large",onClick:()=>{const e=null===i||void 0===i?void 0:i.dataset_id,t=(null===i||void 0===i||i.type,ie.DE.MasterDataset,null===i||void 0===i||i.status,`/home/ingestion/schema-details/${e}`);window.location.href=t},children:(0,z.jsx)(ue.A,{})})}),(0,z.jsx)(r.A,{title:"Export Dataset",children:(0,z.jsx)(h.A,{color:"primary",size:"large",onClick:e=>(async(e,t,a,s)=>{try{const t=await(0,X.r$)(e,ie.Zs.Draft),a=v.get(t,"data.result");if(a){const e=v.get((0,de.Mt)({schema:a},{schema:(0,de.E4)(null===a||void 0===a?void 0:a.data_schema)}),"schema");(0,ne.z)(e,s)}}catch(i){console.log(i),y((0,W.z3)({message:"Unable to export dataset"}))}})(null===i||void 0===i?void 0:i.dataset_id,null===i||void 0===i||i.version,null===i||void 0===i||i.status,l),"data-objectid":null===i||void 0===i?void 0:i.dataset_id,"data-objecttype":(null===i||void 0===i?void 0:i.type)===ie.DE.MasterDataset?"masterDataset":"dataset",disabled:(null===i||void 0===i?void 0:i.type)===n,children:(0,z.jsx)(ve.A,{})})}),(0,z.jsx)(r.A,{title:"Delete Dataset",children:(0,z.jsx)(h.A,{color:"error",size:"large",onClick:e=>(S(i),void o(!0)),"data-objectid":null===i||void 0===i?void 0:i.dataset_id,"data-objecttype":(null===i||void 0===i?void 0:i.type)===ie.DE.MasterDataset?"masterDataset":"dataset",children:(0,z.jsx)(be.A,{})})})]})}}]),[]),L=()=>{w(null)},Y=(e,t)=>{w(e.currentTarget),b(t)};return(0,z.jsxs)(g.A,{content:!1,children:[j&&(0,z.jsx)(_e.A,{}),(0,z.jsx)(ye.A,{open:j}),j?(0,se.Y)({config:{type:"table",width:"100%"}}):(0,z.jsx)(z.Fragment,{children:v.isEmpty(i)?qe(K["datasets-not-found"]):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(x.A,{children:(0,z.jsx)(M,{columns:$,data:v.orderBy(i,["created_date"],["desc"]),title:"Ready For Publish Datasets",toggleRefresh:D})}),(0,z.jsx)(I.A,{open:n,handleClose:e=>{o(!1)},context:we(v.get(T,"name")),action:async()=>{if(T){A(!0);try{await(0,X.gu)({id:v.get(T,"dataset_id")}),y((0,W.kX)({message:K["dataset-delete-success"]}))}catch(e){const t=v.get(e,"response.data.params.errmsg")||K["dataset-delete-failure"];y((0,W.z3)({message:t}))}finally{await R(),C((0,ae.A)()),A(!1),S(null)}}}}),(0,z.jsx)(V,{dataset:f,handleClose:P,handleSave:async(e,t)=>{const{dataset_id:a,name:s,status:i,id:l,tags:n}=e,o=(0,X.lX)({tags:n,tagsData:t}),r={dataset_id:a,name:s,...v.size(o)&&{tags:o}};try{A(!0);await(0,X.yE)({data:{...r}});(e=>{let{dataset_id:t,status:a,id:s,name:i,tags:l}=e;d((e=>{let d=v.cloneDeep(e);const n=v.findIndex(d,(e=>t===v.get(e,"dataset_id")&&a===v.get(e,"status")&&s===v.get(e,"id")&&i===v.get(e,"name")));return v.set(d[n],"tags",l),d})),P()})({dataset_id:a,status:i,id:l,name:s,tags:t}),C((0,ae.A)())}catch(c){y((0,W.z3)({message:K["dataset-update-tags-failure"]}))}finally{L(),A(!1)}},open:k,anchorEl:_})]})})]})};var Pe=a(35475);const $e=(e,t)=>(v.map(t,(t=>{const a=v.get(e,"sources")||[];(t=>v.get(e,"dataset_id")===v.get(t,"dataset_id")&&v.get(e,"status")===v.get(t,"status"))(t)&&v.set(e,"sources",v.map([v.get(t,"connector_type"),...a],v.toUpper))})),v.set(e,"sources",["API",...v.uniq(v.get(e,"sources")||[])]),e),Le=(e,t)=>(null!==e&&void 0!==e&&e.sources||(v.set(e,"sources",["API"]),v.forEach(t,(t=>{if((null===e||void 0===e?void 0:e.id)===(null===t||void 0===t?void 0:t.dataset_id)){const a=null===e||void 0===e?void 0:e.sources;v.uniq(a.push(v.toUpper(null===t||void 0===t?void 0:t.connector_type))),v.set(e,"sources",a)}}))),e),Ye=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,z.jsx)(le.A,{id:"datasets-not-found"});return(0,z.jsx)(i.A,{severity:"error",sx:{lineHeight:0,mt:2},children:(0,z.jsx)(l.A,{variant:"caption",fontSize:14,children:e})})},qe=e=>(0,z.jsx)(d.Ay,{item:!0,xs:12,children:Ye(e)}),Ge=()=>{const e=(0,n.A)(),[t]=(0,Pe.ok)(),a=t.get("status")||ie.Zs.Live,i=(0,E.Zp)();(0,Ce.A)({type:"list",pageid:v.get(Te.A,"dataset.list")});const[p,m]=(0,s.useState)(a),g=(e,t)=>{m(t),i(`?status=${t}`)},x=e=>{switch(e){case ie.Zs.Live:return(0,z.jsx)(d.Ay,{item:!0,xs:12,children:(0,z.jsx)(fe,{setDatasetType:m})});case ie.Zs.ReadyToPublish:return(0,z.jsx)(d.Ay,{item:!0,xs:12,children:(0,z.jsx)(He,{setDatasetType:m})});case ie.Zs.Draft:return(0,z.jsx)(d.Ay,{item:!0,xs:12,children:(0,z.jsx)(De,{})});case ie.Zs.Retired:return(0,z.jsx)(d.Ay,{item:!0,xs:12,children:(0,z.jsx)(Se,{})});default:return qe("No Datasets")}},h=[{id:ie.Zs.Live,label:(0,z.jsx)(le.A,{id:"dataset-live-header"}),color:"success",tooltip:(0,z.jsx)(le.A,{id:"dataset-live-tooltip"})},{id:ie.Zs.ReadyToPublish,label:(0,z.jsx)(le.A,{id:"dataset-publish-header"}),color:"info",tooltip:(0,z.jsx)(le.A,{id:"dataset-publish-tooltip"})},{id:ie.Zs.Draft,label:(0,z.jsx)(le.A,{id:"dataset-draft-header"}),color:"warning",tooltip:(0,z.jsx)(le.A,{id:"dataset-draft-tooltip"})},{id:ie.Zs.Retired,label:(0,z.jsx)(le.A,{id:"dataset-retired-header"}),color:"secondary",tooltip:(0,z.jsx)(le.A,{id:"dataset-retired-tooltip"})},{id:ie.Zs.Purged,label:(0,z.jsx)(le.A,{id:"dataset-purged-header"}),color:"error",tooltip:(0,z.jsx)(le.A,{id:"dataset-purged-tooltip"})}],y=[{id:"import",label:(0,z.jsx)(le.A,{id:"dataset-actions-import"}),icon:(0,z.jsx)(Ee.A,{}),onClick:()=>{i("/datasets/import")},disabled:!1},{id:"add-dataset",label:(0,z.jsx)(le.A,{id:"dataset-actions-add-dataset"}),onClick:()=>i("/dataset/new"),icon:(0,z.jsx)(ze.A,{}),disabled:!1},{id:"add-master-dataset",label:(0,z.jsx)(le.A,{id:"dataset-actions-add-master-dataset"}),onClick:()=>i("/dataset/new/master?master=true"),icon:(0,z.jsx)(ze.A,{}),disabled:!1}],j=e=>{const{id:t,label:a,onClick:s,disabled:i,icon:d}=e;return(0,z.jsx)(q.A,{startIcon:d,size:"medium",type:"button",disabled:i,onClick:s,sx:{mx:1},variant:"contained",children:(0,z.jsx)(l.A,{variant:"body1",children:a})},t)},A=t=>{const{id:a,label:s,color:i,tooltip:d}=t;return(0,z.jsx)(o.A,{sx:{border:0,"&.Mui-selected":{backgroundColor:e.palette.primary.main,color:"white"}},label:(0,z.jsx)(r.A,{title:d,children:(0,z.jsxs)(c.A,{alignItems:"center",display:"flex",children:[(0,z.jsx)(J.A,{color:i,sx:{fontSize:"1.25rem",mr:1}}),(0,z.jsx)(l.A,{variant:"body1",fontWeight:500,children:s})]})}),value:a})};return(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(Ie.Ay,{value:p,children:(0,z.jsxs)(c.A,{children:[(0,z.jsx)(c.A,{sx:{background:"#FFFFFF",borderColor:"#f1f1f1"},children:(0,z.jsxs)(u.A,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,z.jsx)(ke.A,{variant:"standard",onChange:g,TabIndicatorProps:{hidden:!0},children:v.map(h,A)}),(0,z.jsx)(d.Ay,{children:v.map(y,j)})]})}),(0,z.jsx)(c.A,{marginTop:1,children:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Me.A,{sx:{p:0},value:ie.Zs.Live,children:x(ie.Zs.Live)}),(0,z.jsx)(Me.A,{sx:{p:0},value:ie.Zs.ReadyToPublish,children:x(ie.Zs.ReadyToPublish)}),(0,z.jsx)(Me.A,{sx:{p:0},value:ie.Zs.Draft,children:x(ie.Zs.Draft)}),(0,z.jsx)(Me.A,{sx:{p:0},value:ie.Zs.Retired,children:x(ie.Zs.Retired)}),(0,z.jsx)(Me.A,{sx:{p:0},value:ie.Zs.Purged,children:x(ie.Zs.Purged)})]})})]})})})}},91063:(e,t,a)=>{a.d(t,{v:()=>s});const s={druid_avg_processing_time:e=>{let{datasetId:t,intervals:a,master:s=!1}=e;const i="system-events";return{context:{dataSource:i},query:{queryType:"groupBy",dataSource:i,intervals:a,granularity:{type:"all",timeZone:"Asia/Kolkata"},filter:{type:"and",fields:[{type:"selector",dimension:"ctx_module",value:"processing"},{type:"selector",dimension:"ctx_dataset",value:t},{type:"selector",dimension:"ctx_pdata_pid",value:"router"},{type:"selector",dimension:"error_code",value:null}]},aggregations:[{type:"longSum",name:"processing_time",fieldName:"total_processing_time"},{type:"longSum",name:"count",fieldName:"count"}],postAggregations:[{type:"expression",name:"average_processing_time",expression:"case_searched((count > 0),(processing_time/count),0"}]}}},druid_max_processing_time:e=>{let{datasetId:t,intervals:a,master:s=!1}=e;const i="system-events";return{context:{dataSource:i},query:{queryType:"topN",dataSource:i,virtualColumns:[{type:"expression",name:"v0",expression:"case_searched((count > 0),(total_processing_time/count),0",outputType:"DOUBLE"}],dimension:{type:"default",dimension:"dataset",outputName:"dataset",outputType:"STRING"},threshold:100,metric:{type:"numeric",metric:"max_processing_time"},filter:{type:"and",fields:[{type:"selector",dimension:"ctx_module",value:"processing"},{type:"selector",dimension:"ctx_dataset",value:t},{type:"selector",dimension:"ctx_pdata_pid",value:"router"},{type:"selector",dimension:"error_code",value:null}]},intervals:a,granularity:{type:"all",timeZone:"Asia/Kolkata"},aggregations:[{type:"doubleMax",name:"max_processing_time",fieldName:"v0"}]}}},druid_min_processing_time:e=>{let{datasetId:t,intervals:a,master:s=!1}=e;const i="system-events";return{context:{dataSource:i},query:{queryType:"topN",dataSource:i,virtualColumns:[{type:"expression",name:"v0",expression:"case_searched((count > 0),(total_processing_time/count),0",outputType:"DOUBLE"}],dimension:{type:"default",dimension:"dataset",outputName:"dataset",outputType:"STRING"},threshold:100,metric:{type:"numeric",metric:"min_processing_time"},filter:{type:"and",fields:[{type:"selector",dimension:"ctx_module",value:"processing"},{type:"selector",dimension:"ctx_dataset",value:t},{type:"selector",dimension:"ctx_pdata_pid",value:"router"},{type:"selector",dimension:"error_code",value:null}]},intervals:a,granularity:{type:"all",timeZone:"Asia/Kolkata"},aggregations:[{type:"doubleMin",name:"min_processing_time",fieldName:"v0"}]}}},last_synced_time:e=>{let{datasetId:t,intervals:a,master:s=!1}=e;const i="system-events";return{context:{dataSource:i},query:{queryType:"groupBy",dataSource:i,intervals:a,granularity:{type:"all",timeZone:"Asia/Kolkata"},filter:{type:"and",fields:[{type:"selector",dimension:"ctx_module",value:"processing"},{type:"selector",dimension:"ctx_dataset",value:t},{type:"selector",dimension:"ctx_pdata_pid",value:"router"}]},aggregations:[{type:"longMax",name:"last_synced_time",fieldName:"__time"}]}}},total_events_processed:e=>{let{datasetId:t,intervals:a,master:s=!1}=e;const i="system-events";return{context:{dataSource:i},query:{queryType:"timeseries",dataSource:i,intervals:a,granularity:{type:"all",timeZone:"Asia/Kolkata"},filter:{type:"and",fields:[{type:"selector",dimension:"ctx_module",value:"processing"},{type:"selector",dimension:"ctx_dataset",value:t},{type:"selector",dimension:"ctx_pdata_pid",value:"router"},{type:"selector",dimension:"error_code",value:null}]},aggregations:[{type:"longSum",name:"count",fieldName:"count"}]}}},totalEventsProcessedTimeSeries:e=>{let{datasetId:t,intervals:a,master:s=!1}=e;const i="system-events";return{context:{dataSource:i},query:{queryType:"timeseries",dataSource:i,intervals:a,granularity:{type:"period",period:"PT5M",timeZone:"Asia/Kolkata"},filter:{type:"and",fields:[{type:"selector",dimension:"ctx_module",value:"processing"},{type:"selector",dimension:"ctx_dataset",value:t},{type:"selector",dimension:"ctx_pdata_pid",value:"router"},{type:"selector",dimension:"error_code",value:null}]},aggregations:[{type:"count",name:"count",fieldName:"count"}]}}},failedEventsCount:e=>{let{datasetId:t,intervals:a,master:s=!1}=e;const i="system-events";return{context:{dataSource:i},query:{queryType:"timeseries",dataSource:i,intervals:a,granularity:{type:"all",timeZone:"Asia/Kolkata"},filter:{type:"and",fields:[{type:"selector",dimension:"ctx_module",value:"processing"},{type:"selector",dimension:"ctx_dataset",value:t},{type:"selector",dimension:"ctx_pdata_pid",value:"router"},{type:"not",field:{type:"selector",dimension:"error_code",value:null}}]},aggregations:[{type:"longSum",name:"count",fieldName:"error_count"}]}}}}},47830:(e,t,a)=>{a.d(t,{C:()=>n,h:()=>o});var s=a(18666),i=a(92073),l=a(78293),d=a(79074);const n=e=>{let{data:t,config:a={}}=e;const{datasetId:i}=t,n=(0,d.Fj)({apiId:"api.datasets.status-transition",request:{dataset_id:i,status:"Live"}});return s.LV.post(l.A.statusTransition,n,a)},o=(e,t)=>{const a={id:(0,i.A)(),dataset_id:t,data:[{...e}]};return s.LV.post(l.A.detectPiiFields,a)}},74865:(e,t,a)=>{a.d(t,{z:()=>l});var s=a(53536),i=a.n(s);const l=function(e,t){const a=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e:i().omit(e,["properties","required"]),s=JSON.stringify(a,null,2),l=new Blob([s],{type:"application/json"}),d=URL.createObjectURL(l),n=document.createElement("a");n.href=d,n.download=t+".json",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(d)}}}]);
//# sourceMappingURL=318.152ea4dd.chunk.js.map