"use strict";(self.webpackChunksunbird_obsrv=self.webpackChunksunbird_obsrv||[]).push([[220,174],{99600:(e,t,r)=>{r.d(t,{A:()=>n});const n={home:{home:"home"},login:"login",metrics:{infra:"metrics:infra",overallInfra:"metrics:infra",api:"metrics:api",ingestion:"metrics:ingestion",processing:"metrics:processing",storage:"metrics:storage"},dataset:{list:"dataset:list",create:"dataset:create",edit:"dataset:edit",pages:{schema:"json-schema",input:"input",field:"fields",processing:"processing",advanced:"advanced",review:"review"}},masterdataset:{create:"masterDataset:create",edit:"masterDataset:edit",pages:{schema:"json-schema",input:"input",field:"fields",review:"review"}},systemSettings:{list:"systemSettings:list"}}},13691:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(65043),s=r(73216),a=r(60028);const i=e=>{let{type:t="",subtype:r="PAGINATE",pageid:i,object:c={}}=e;const l=(0,s.zy)(),{pathname:o}=l,d={type:t,subtype:r,pageid:i||o,uri:o};(0,n.useEffect)((()=>{(0,a.rH)({edata:d,object:c})}),[i])}},21220:(e,t,r)=>{r.r(t),r.d(t,{default:()=>S});var n=r(65043),s=r(81e3),a=r(24056),i=r(68903),c=r(57904),l=r(77366),o=r(63174),d=r(74600),m=r(12110),u=r(22698),h=r(85865),x=r(28818),g=r(39205),p=r(10611),A=r(79226),j=r(15813),y=r(57332),v=r(53536),f=r(70579);const b=()=>{const e=(0,n.useMemo)((()=>[{label:"CPU Usage",metadata:x.A.cpu_percentage,value:0,colors:{primary:[0,79],warning:[80,90],error:[91,100]}},{label:"Memory Usage",metadata:x.A.memory_percentage,value:0,colors:{primary:[0,79],warning:[80,90],error:[91,100]}},{label:"Disk Usage",metadata:x.A.pv_usage_percent,value:0,colors:{primary:[0,59],warning:[60,79],error:[80,100]}}]),[]),[t,r]=(0,n.useState)(e),s=(e,t)=>{if(0===t)return"error";const{colors:r}=e;return v.findKey(r,(e=>{const[r,n]=e;return t>=r&&t<=n}))||"primary"},a=async()=>{try{const e=await Promise.all(v.map(t,(e=>(0,y.p)(e.metadata.query).then((t=>({...e,value:t}))))));r(e)}catch(n){r(e)}};return(0,n.useEffect)((()=>{const{frequency:e}=j.A.clusterMenu;a();const t=setInterval((()=>{a()}),1e3*e);return()=>clearInterval(t)}),[]),(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(A.A,{style:{background:"inherit",border:"unset"},title:"",contentSX:{px:2},children:(0,f.jsx)(i.Ay,{container:!0,spacing:3,children:t.map((e=>{const{label:t,value:r=0}=e;return(0,f.jsx)(i.Ay,{item:!0,xs:12,children:(0,f.jsxs)(i.Ay,{container:!0,alignItems:"center",spacing:1,children:[(0,f.jsx)(i.Ay,{item:!0,sm:!0,zeroMinWidth:!0,children:(0,f.jsx)(h.A,{variant:"h6",children:t})}),(0,f.jsx)(i.Ay,{item:!0,children:(0,f.jsxs)(h.A,{variant:"h6",align:"right",children:[r,"%"]})}),(0,f.jsx)(i.Ay,{item:!0,xs:12,children:(0,f.jsx)(p.A,{variant:"determinate",value:r,color:s(e,r)})})]})},Math.random())}))})})})};var w=r(85218),I=r(635);const M=e=>{const t=(0,n.useMemo)((()=>[x.A.total_nodes_count,x.A.total_running_nodes_count]),[]),[r,s]=(0,n.useState)({percentage:0,label:"0/0 Nodes Running"}),a=async()=>{try{const[e,r]=await Promise.all(v.map(t,(e=>(0,y.p)(e.query)))),n=e&&r/e||0;s({percentage:n,label:`${r} / ${e} Nodes Running`})}catch(e){}};(0,n.useEffect)((()=>{const e=(()=>{a();const e=j.A.clusterMenu.frequency;return setInterval((()=>{a()}),1e3*e)})();return()=>{e&&clearInterval(e)}}),[]);const i=e=>(0,f.jsx)(w.A,{arcsLength:null,nrOfLevels:20,colors:["#EA4228","#5BE12C"],percentage:e,className:"cluster-node"});return(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(d.A,{direction:"column",justifyContent:"center",alignItems:"center",...e,children:[v.get(r,"percentage")?i(v.get(r,"percentage")):i(0),(0,f.jsx)(I.A,{align:"center",variant:"body2",suffix:v.get(r,"label")})]})})},$=()=>(0,f.jsxs)(d.A,{spacing:0,children:[(0,f.jsxs)(d.A,{direction:{lg:"row",md:"row",sm:"row",xs:"column"},justifyContent:"flex-start",alignItems:"stretch",gap:1.5,sx:{position:"relative",zIndex:5},children:[(0,f.jsx)(m.A,{elevation:2,sx:{width:"100%",p:1},children:(0,f.jsxs)(d.A,{direction:"row",spacing:0,justifyContent:"space-between",alignItems:"center",width:"100%",height:"100%",children:[(0,f.jsx)(M,{sx:{maxWidth:160}}),(0,f.jsx)(b,{})]})}),(0,f.jsx)(m.A,{elevation:2,sx:{width:"100%",p:1},children:(0,f.jsx)(g.A,{metadata:x.A.node_cpu,step:"30s"})}),(0,f.jsx)(m.A,{elevation:2,sx:{width:"100%",p:1},children:(0,f.jsx)(g.A,{metadata:x.A.node_memory,step:"30s"})})]}),(0,f.jsx)(d.A,{direction:"row",justifyContent:"flex-end",alignItems:"center",spacing:2,mt:2,children:(0,f.jsxs)(u.A,{"aria-label":"breadcrumb",children:[(0,f.jsxs)(h.A,{variant:"body3",children:["Interval: ",j.A.clusterMenu.interval," Min"]}),(0,f.jsxs)(h.A,{variant:"body3",children:["Frequency: ",j.A.clusterMenu.frequency," Sec"]})]})})]});function C(e){const{children:t,value:r,index:n,id:a,...i}=e;return(0,f.jsx)("div",{role:"tabpanel",hidden:r!==n,id:`metrics-tabpanel-${n}`,"aria-labelledby":`metrics-tab-${n}`,...i,children:r===n&&(0,f.jsx)(s.A,{sx:{pt:3},children:t})})}const _=()=>{const[e,t]=(0,n.useState)(0);return(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(i.Ay,{container:!0,spacing:3,children:[(0,f.jsx)(i.Ay,{item:!0,xs:12,children:(0,f.jsx)($,{})}),(0,f.jsx)(i.Ay,{item:!0,xs:12,id:"tabSectionStart",children:(0,f.jsxs)(s.A,{sx:{width:"100%"},children:[(0,f.jsx)(s.A,{sx:{},children:(0,f.jsx)(c.A,{variant:"fullWidth",value:e,onChange:(e,r)=>{t(r)},"aria-label":"metrics tabs",sx:{background:"#FFFFFF",padding:1},children:l.v.map(((e,t)=>{const{menuIcon:r,id:n,primaryLabel:s,rotate:i}=e,c=r;return(0,f.jsx)(a.A,{"data-edataid":`home:metrics:tabs:${s.toLowerCase()}`,label:s,id:n,icon:(0,f.jsx)(c,{rotate:i}),iconPosition:"start","aria-controls":`metrics-tabpanel-${t}`},t)}))})}),l.v.map(((t,r)=>{const{id:n}=t;return(0,f.jsx)(C,{value:e,index:r,id:n,children:(0,f.jsx)(o.default,{id:n,showClusterPanel:!0})},r)}))]})})]})})};var F=r(97508),k=r(43482),E=r(13691),L=r(99600);const S=()=>{(0,E.A)({type:"home",pageid:L.A.home.home});const e=(0,F.wA)();return(0,n.useEffect)((()=>{e((0,k.C)({}))}),[]),(0,f.jsx)(_,{})}},63174:(e,t,r)=>{r.r(t),r.d(t,{default:()=>q});var n=r(53536),s=r.n(n),a=r(68903),i=r(85865),c=r(69392),l=r(74600),o=r(85976),d=r(65043),m=r(97508),u=r(79226),h=r(77366),x=r(73216),g=r(8387),p=r(94786),A=r(81045),j=r(41121);var y=r(26240),v=r(54011),f=r(99600),b=r(13691),w=r(73012),I=r(92073),M=r(66734),$=r(70579);const C=(0,M.A)([(0,$.jsx)("path",{d:"M15.11 12.45 14 10.24l-3.11 6.21c-.16.34-.51.55-.89.55s-.73-.21-.89-.55L7.38 13H2v5c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2v-5h-6c-.38 0-.73-.21-.89-.55"},"0"),(0,$.jsx)("path",{d:"M20 4H4c-1.1 0-2 .9-2 2v5h6c.38 0 .73.21.89.55L10 13.76l3.11-6.21c.34-.68 1.45-.68 1.79 0L16.62 11H22V6c0-1.1-.9-2-2-2"},"1")],"MonitorHeart");var _=r(15244),F=r(7943),k=r(43845),E=r(15813),L=r(57332);const S=e=>{const t={color:"success",label:"Loading Health..."},{metadata:r}=e,{query:n,transformer:a}=r,[i,c]=(0,d.useState)(t),l=async()=>{try{const e=await(Array.isArray(n)?(0,L._)(n):(0,L.p)(n));(e=>{if(Array.isArray(e)){const[t,r]=e;c({color:r,label:t})}else c({color:"success",label:e})})(a&&a(e)||e)}catch(e){}};return(0,d.useEffect)((()=>{c(t);const e=(()=>{const e=E.A.clusterMenu.frequency;return l(),setInterval((()=>l()),1e3*e)})();return()=>e&&clearInterval(e)}),[n,a]),(0,$.jsx)("div",{onClick:e=>l(),children:(0,$.jsx)(k.A,{icon:(()=>{const e=s().toLower(s().get(i,"label"));return["healthy","unhealthy"].includes(e)?"healthy"===e?(0,$.jsx)(_.A,{}):(0,$.jsx)(F.A,{}):(0,$.jsx)(C,{})})(),color:s().get(i,"color"),label:s().get(i,"label")})})},q=e=>{const{id:t}=e,r=(0,y.A)(),s=(0,m.wA)(),M=(0,x.Zp)(),C=(0,x.g)(),[_,F]=(0,d.useState)(),k=(r.palette.mode,t||n.get(C,"metricId"));(0,b.A)({type:"detail",pageid:n.get(f.A,["metrics",k])});const E=e=>{let{errMsg:t}=e;M("/"),t&&s((0,g.z3)({message:t}))};(0,d.useEffect)((()=>{(()=>{k||E({errMsg:"Metric Id Missing"});const e=n.find(h.v,["id",k]);e||E({errMsg:"Invalid Metric"}),F(e)})()}),[k]);return(0,$.jsx)($.Fragment,{children:(0,$.jsx)(u.A,{title:(()=>{const e=n.get(_,"health");return(0,$.jsx)($.Fragment,{children:(0,$.jsxs)(l.A,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[(0,$.jsx)("div",{children:`${(null===_||void 0===_?void 0:_.primaryLabel)||""} Metrics `}),e&&(0,$.jsx)(S,{metadata:e}),(0,$.jsx)(c.A,{title:null===_||void 0===_?void 0:_.description,children:(0,$.jsx)(p.A,{})})]})})})(),secondary:(()=>{const e=n.get(_,"links.grafana.link");return e?(0,$.jsx)(c.A,{title:"Navigate to Grafana Dashboard",onClick:t=>(e=>{const t=(0,j.Ct)("GRAFANA_URL");if(t){const r=`${t}/${e}`;window.open(r)}})(e),children:(0,$.jsx)(o.A,{"data-edataid":`${w.grafana_navigate}:${k}`,color:"secondary",variant:"light",sx:{color:"text.primary",bgcolor:"transparent",ml:.75},children:(0,$.jsx)(A.A,{alt:"Gradana",src:v.A})})}):null})(),children:(0,$.jsx)(a.Ay,{container:!0,spacing:2,marginBottom:1,alignItems:"stretch",children:(e=>{if(e){const{charts:t}=e;return n.flatten(n.map(t,((e,t)=>{const{size:r,metadata:s=[],groups:c=[]}=e,{xs:l,sm:o,lg:m,md:u}=r,h=n.map(c,(e=>{const{metadata:t,title:r}=e;return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(a.Ay,{item:!0,xs:12,children:(0,$.jsx)(i.A,{variant:"h5",children:r})}),n.map(t,((e,t)=>{const{id:r=(0,I.A)(),chart:n,description:s,noItem:i=!1,size:c={}}=e,{xs:h,sm:x,lg:g,md:p}=c;return i?d.cloneElement(n,{description:s,metricId:k,key:`${t}-${Math.random()}`}):(0,$.jsx)(a.Ay,{item:!0,xs:h||l,sm:x||o,md:p||u,lg:g||m,alignItems:"stretch",children:d.cloneElement(n,{description:s,metricId:k,uuid:r})},`${t}-${Math.random()}`)})),(0,$.jsx)(a.Ay,{item:!0,xs:12})]})})),x=n.map(s,((e,t)=>{const{id:r=(0,I.A)(),chart:n,description:s,noItem:i=!1}=e;return i?d.cloneElement(n,{description:s,metricId:k,key:`${t}-${Math.random()}`}):(0,$.jsx)(a.Ay,{item:!0,xs:l,sm:o,md:u,lg:m,alignItems:"stretch",children:d.cloneElement(n,{description:s,metricId:k,uuid:r})},`${t}-${Math.random()}`)}));return n.size(c)>0?h:x})))}})(_)})})})}}}]);
//# sourceMappingURL=220.f12faf74.chunk.js.map